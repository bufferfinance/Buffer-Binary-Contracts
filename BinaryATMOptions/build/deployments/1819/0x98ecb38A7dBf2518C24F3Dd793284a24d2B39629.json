{"allSourcePaths": {"19": "contracts/Libraries/OptionFeeCalculator.sol", "20": "contracts/Libraries/OptionMath.sol", "28": "contracts/Pool/BufferIBFRPoolV2.sol", "13": "/home/lenovo/.brownie/packages/OpenZeppelin/openzeppelin-contracts@4.3.2/contracts/utils/Context.sol", "4": "/home/lenovo/.brownie/packages/OpenZeppelin/openzeppelin-contracts@4.3.2/contracts/token/ERC20/ERC20.sol", "5": "/home/lenovo/.brownie/packages/OpenZeppelin/openzeppelin-contracts@4.3.2/contracts/token/ERC20/IERC20.sol", "6": "/home/lenovo/.brownie/packages/OpenZeppelin/openzeppelin-contracts@4.3.2/contracts/token/ERC20/extensions/IERC20Metadata.sol", "27": "contracts/Options/OptionConfig.sol"}, "bytecode": "610c9661003a600b82828239805160001a60731461002d57634e487b7160e01b600052600060045260246000fd5b30600052607381538281f3fe73000000000000000000000000000000000000000030146080604052600436106100775760003560e01c80630cd5f90f1461007c5780630e04d1bc146100a257806327150148146100d0578063c4653f31146100e3578063ce460184146100f6578063d13a79bc14610109578063e39d06e91461011c575b600080fd5b61008f61008a366004610a0f565b61012f565b6040519081526020015b60405180910390f35b6100b56100b036600461092c565b61027c565b60408051938452602084019290925290820152606001610099565b6100b56100de366004610aff565b6102b7565b6100b56100f1366004610aff565b6103b7565b61008f610104366004610a3e565b6104a7565b6100b5610117366004610a7f565b6105de565b61008f61012a366004610a7f565b61061b565b600080826001600160a01b031663d9ac10d96040518163ffffffff1660e01b815260040160206040518083038186803b15801561016b57600080fd5b505afa15801561017f573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906101a391906109f7565b9050600081116101de5760405162461bcd60e51b815260206004820152600260248201526109e760f31b604482015260640160405180910390fd5b8084846001600160a01b0316636ab28bc86040518163ffffffff1660e01b815260040160206040518083038186803b15801561021957600080fd5b505afa15801561022d573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061025191906109f7565b61025b9190610bc4565b61026a906402540be400610bfc565b6102749190610bdc565b949350505050565b600080600061028e8885878a8a6106df565b905061029e8860200151866107b9565b91506102aa8183610bc4565b9250955095509592505050565b60008060008073__OptionMath____________________________632c607c3b6102e28c888a6104a7565b8b8a8f60028e600281111561030757634e487b7160e01b600052602160045260246000fd5b146040518663ffffffff1660e01b8152600401610328959493929190610b73565b60206040518083038186803b15801561034057600080fd5b505af4158015610354573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061037891906109f7565b9050866103858b83610bfc565b61038f9190610bdc565b915061039b8a876107b9565b92506103a78284610bc4565b9350509750975097945050505050565b60008060008073__OptionMath____________________________632c607c3b6103e28c888a6104a7565b8b8a8f60028e600281111561040757634e487b7160e01b600052602160045260246000fd5b146040518663ffffffff1660e01b8152600401610428959493929190610b73565b60206040518083038186803b15801561044057600080fd5b505af4158015610454573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061047891906109f7565b90506104848a876107b9565b9250866104918b83610bfc565b61049b9190610bdc565b91506103a78284610bc4565b6000816001600160a01b03166318f88e5b6040518163ffffffff1660e01b815260040160206040518083038186803b1580156104e257600080fd5b505afa1580156104f6573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061051a91906109f7565b90506000610528858561012f565b905063ee6b28008111156105d657826001600160a01b0316636c321c8a6040518163ffffffff1660e01b815260040160206040518083038186803b15801561056f57600080fd5b505afa158015610583573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906105a791906109f7565b6105b563ee6b280083610c1b565b6105bf9084610bfc565b6105c99190610bdc565b6105d39083610bc4565b91505b509392505050565b60008060006105f38a85878c8f8b8e8e610849565b90506105ff8a866107b9565b915061060b8183610bc4565b9250985098509895505050505050565b60006305f5e1008873__OptionMath____________________________63d573d6156106488c87896104a7565b8b898f8d8d6040518763ffffffff1660e01b815260040161066e96959493929190610b98565b60206040518083038186803b15801561068657600080fd5b505af415801561069a573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906106be91906109f7565b6106c89190610bfc565b6106d29190610bdc565b9998505050505050505050565b60008073__OptionMath____________________________63d573d61561070b896020015189896104a7565b6040808b01518b5160608d015160808e015193516001600160e01b031960e088901b16815261074195948b939291600401610b98565b60206040518083038186803b15801561075957600080fd5b505af415801561076d573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061079191906109f7565b9050838760200151826107a49190610bfc565b6107ae9190610bdc565b979650505050505050565b60006064826001600160a01b031663f3fa34956040518163ffffffff1660e01b815260040160206040518083038186803b1580156107f657600080fd5b505afa15801561080a573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061082e91906109f7565b6108389085610bfc565b6108429190610bdc565b9392505050565b60008073__OptionMath____________________________63d573d6156108718c8c8c6104a7565b89888a89896040518763ffffffff1660e01b815260040161089796959493929190610b98565b60206040518083038186803b1580156108af57600080fd5b505af41580156108c3573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906108e791906109f7565b9050846108f48b83610bfc565b6108fe9190610bdc565b9a9950505050505050505050565b8035801515811461091c57600080fd5b919050565b803561091c81610c48565b6000806000806000858703610120811215610945578182fd5b60a0811215610952578182fd5b5060405160a081016001600160401b038111828210171561098157634e487b7160e01b83526041600452602483fd5b80604052508635815260208701356020820152604087013560408201526109aa6060880161090c565b60608201526109bb6080880161090c565b6080820152945060a0860135935060c086013592506109dc60e08701610921565b91506109eb6101008701610921565b90509295509295909350565b600060208284031215610a08578081fd5b5051919050565b60008060408385031215610a21578182fd5b823591506020830135610a3381610c48565b809150509250929050565b600080600060608486031215610a52578283fd5b833592506020840135610a6481610c48565b91506040840135610a7481610c48565b809150509250925092565b600080600080600080600080610100898b031215610a9b578283fd5b883597506020890135965060408901359550610ab960608a0161090c565b9450610ac760808a0161090c565b935060a0890135925060c0890135610ade81610c48565b915060e0890135610aee81610c48565b809150509295985092959890939650565b600080600080600080600060e0888a031215610b19578283fd5b873596506020880135955060408801359450606088013560038110610b3c578384fd5b93506080880135925060a0880135610b5381610c48565b915060c0880135610b6381610c48565b8091505092959891949750929550565b9485526020850193909352604084019190915260608301521515608082015260a00190565b95865260208601949094526040850192909252606084015215156080830152151560a082015260c00190565b60008219821115610bd757610bd7610c32565b500190565b600082610bf757634e487b7160e01b81526012600452602481fd5b500490565b6000816000190483118215151615610c1657610c16610c32565b500290565b600082821015610c2d57610c2d610c32565b500390565b634e487b7160e01b600052601160045260246000fd5b6001600160a01b0381168114610c5d57600080fd5b5056fea26469706673582212204718cc67318816a547e043d04e886f3154ceacf08e3ac1e83de0647cead34ada64736f6c63430008040033", "bytecodeSha1": "26e45cff2ec04c40fa1a0c99acc0b1897bf54732", "coverageMap": {"statements": {"19": {"FeeCalculator.getNewUtilisation": {"0": [1093, 1123], "1": [1134, 1202]}, "FeeCalculator.feesKPIBinary": {"2": [8473, 8617], "3": [8627, 8689], "4": [8699, 8730]}, "FeeCalculator.fees": {"5": [3279, 3325], "6": [3335, 3383], "7": [3393, 3424]}, "FeeCalculator.feesUsd": {"8": [4821, 4869], "9": [4879, 4925], "10": [4935, 4966]}, "FeeCalculator.currentImpliedVolatility": {"11": [1700, 1728], "12": [1839, 1899]}, "FeeCalculator.feesBinary": {"13": [7292, 7486], "14": [7496, 7544], "15": [7554, 7585]}, "FeeCalculator.feesTokenXBinary": {"16": [5920, 6155]}, "FeeCalculator.getPremiumBinary": {"17": [10349, 10409]}, "FeeCalculator.getSettlementFee": {"18": [9012, 9068]}, "FeeCalculator.getPremium": {"19": [9669, 9715]}}, "20": {}, "28": {}, "13": {}, "4": {}, "5": {}, "6": {}, "27": {}}, "branches": {"19": {"FeeCalculator.getNewUtilisation": {"20": [1101, 1116, true]}, "FeeCalculator.currentImpliedVolatility": {"21": [1805, 1823, false]}}, "20": {}, "28": {}, "13": {}, "4": {}, "5": {}, "6": {}, "27": {}}}, "dependencies": ["ABDKMath64x64", "BufferIBFRPoolV2", "OpenZeppelin/openzeppelin-contracts@4.3.2/Context", "OpenZeppelin/openzeppelin-contracts@4.3.2/ERC20", "OpenZeppelin/openzeppelin-contracts@4.3.2/IERC20", "OpenZeppelin/openzeppelin-contracts@4.3.2/IERC20Metadata", "OptionConfig", "OptionMath"], "offset": [668, 10418], "type": "library", "abi": [{"inputs": [{"internalType": "uint256", "name": "amount", "type": "uint256"}, {"internalType": "contract BufferIBFRPoolV2", "name": "pool", "type": "BufferIBFRPoolV2"}, {"internalType": "contract OptionConfig", "name": "config", "type": "OptionConfig"}], "name": "currentImpliedVolatility", "outputs": [{"internalType": "uint256", "name": "iv", "type": "uint256"}], "stateMutability": "view", "type": "function"}, {"inputs": [{"internalType": "uint256", "name": "period", "type": "uint256"}, {"internalType": "uint256", "name": "amount", "type": "uint256"}, {"internalType": "uint256", "name": "strike", "type": "uint256"}, {"internalType": "enum IBufferOptions.OptionType", "name": "optionType", "type": "IBufferOptions.OptionType"}, {"internalType": "uint256", "name": "currentPrice", "type": "uint256"}, {"internalType": "contract OptionConfig", "name": "config", "type": "OptionConfig"}, {"internalType": "contract BufferIBFRPoolV2", "name": "pool", "type": "BufferIBFRPoolV2"}], "name": "fees", "outputs": [{"internalType": "uint256", "name": "total", "type": "uint256"}, {"internalType": "uint256", "name": "settlementFee", "type": "uint256"}, {"internalType": "uint256", "name": "premium", "type": "uint256"}], "stateMutability": "view", "type": "function"}, {"inputs": [{"internalType": "uint256", "name": "period", "type": "uint256"}, {"internalType": "uint256", "name": "amount", "type": "uint256"}, {"internalType": "uint256", "name": "strike", "type": "uint256"}, {"internalType": "bool", "name": "isYes", "type": "bool"}, {"internalType": "bool", "name": "isAbove", "type": "bool"}, {"internalType": "uint256", "name": "currentPrice", "type": "uint256"}, {"internalType": "contract OptionConfig", "name": "config", "type": "OptionConfig"}, {"internalType": "contract BufferIBFRPoolV2", "name": "pool", "type": "BufferIBFRPoolV2"}], "name": "feesBinary", "outputs": [{"internalType": "uint256", "name": "total", "type": "uint256"}, {"internalType": "uint256", "name": "settlementFee", "type": "uint256"}, {"internalType": "uint256", "name": "premium", "type": "uint256"}], "stateMutability": "view", "type": "function"}, {"inputs": [{"components": [{"internalType": "uint256", "name": "period", "type": "uint256"}, {"internalType": "uint256", "name": "amount", "type": "uint256"}, {"internalType": "uint256", "name": "strike", "type": "uint256"}, {"internalType": "bool", "name": "isYes", "type": "bool"}, {"internalType": "bool", "name": "isAbove", "type": "bool"}], "internalType": "struct IBufferOptions.OptionDetails", "name": "optionDetails", "type": "tuple"}, {"internalType": "uint256", "name": "currentPrice", "type": "uint256"}, {"internalType": "uint256", "name": "KPI", "type": "uint256"}, {"internalType": "contract OptionConfig", "name": "config", "type": "OptionConfig"}, {"internalType": "contract BufferIBFRPoolV2", "name": "pool", "type": "BufferIBFRPoolV2"}], "name": "feesKPIBinary", "outputs": [{"internalType": "uint256", "name": "total", "type": "uint256"}, {"internalType": "uint256", "name": "settlementFee", "type": "uint256"}, {"internalType": "uint256", "name": "premium", "type": "uint256"}], "stateMutability": "view", "type": "function"}, {"inputs": [{"internalType": "uint256", "name": "period", "type": "uint256"}, {"internalType": "uint256", "name": "amount", "type": "uint256"}, {"internalType": "uint256", "name": "strike", "type": "uint256"}, {"internalType": "bool", "name": "isYes", "type": "bool"}, {"internalType": "bool", "name": "isAbove", "type": "bool"}, {"internalType": "uint256", "name": "currentPrice", "type": "uint256"}, {"internalType": "contract OptionConfig", "name": "config", "type": "OptionConfig"}, {"internalType": "contract BufferIBFRPoolV2", "name": "pool", "type": "BufferIBFRPoolV2"}], "name": "feesTokenXBinary", "outputs": [{"internalType": "uint256", "name": "premium", "type": "uint256"}], "stateMutability": "view", "type": "function"}, {"inputs": [{"internalType": "uint256", "name": "period", "type": "uint256"}, {"internalType": "uint256", "name": "amount", "type": "uint256"}, {"internalType": "uint256", "name": "strike", "type": "uint256"}, {"internalType": "enum IBufferOptions.OptionType", "name": "optionType", "type": "IBufferOptions.OptionType"}, {"internalType": "uint256", "name": "currentPrice", "type": "uint256"}, {"internalType": "contract OptionConfig", "name": "config", "type": "OptionConfig"}, {"internalType": "contract BufferIBFRPoolV2", "name": "pool", "type": "BufferIBFRPoolV2"}], "name": "feesUsd", "outputs": [{"internalType": "uint256", "name": "total", "type": "uint256"}, {"internalType": "uint256", "name": "settlementFee", "type": "uint256"}, {"internalType": "uint256", "name": "premium", "type": "uint256"}], "stateMutability": "view", "type": "function"}, {"inputs": [{"internalType": "uint256", "name": "amount", "type": "uint256"}, {"internalType": "contract BufferIBFRPoolV2", "name": "pool", "type": "BufferIBFRPoolV2"}], "name": "getNewUtilisation", "outputs": [{"internalType": "uint256", "name": "utilization", "type": "uint256"}], "stateMutability": "view", "type": "function"}], "ast": {"absolutePath": "contracts/Libraries/OptionFeeCalculator.sol", "exportedSymbols": {"ABDKMath64x64": [21705], "AccessControl": [22513], "AggregatorV3Interface": [18691], "BufferIBFRPoolV2": [12690], "Context": [18170], "ERC165": [24356], "ERC20": [9707], "FeeCalculator": [10206], "IAccessControl": [24129], "IBufferOptions": [18557], "IERC165": [24826], "IERC20": [18248], "IERC20Metadata": [18273], "ILiquidityPool": [18401], "INFTCore": [18791], "INFTReceiver": [18573], "IOptionWindowCreator": [18640], "IOptionsConfig": [18620], "IPancakePair": [18285], "IPriceProvider": [18730], "ISlidingWindowOracle": [18810], "OptionConfig": [11465], "OptionMath": [22206], "Ownable": [9121], "Strings": [24332]}, "id": 10207, "license": "BUSL-1.1", "nodeType": "SourceUnit", "nodes": [{"id": 9709, "literals": ["solidity", "^", "0.8", ".0"], "nodeType": "PragmaDirective", "src": "38:23:19"}, {"absolutePath": "contracts/Libraries/OptionMath.sol", "file": "../Libraries/OptionMath.sol", "id": 9710, "nameLocation": "-1:-1:-1", "nodeType": "ImportDirective", "scope": 10207, "sourceUnit": 22207, "src": "513:37:19", "symbolAliases": [], "unitAlias": ""}, {"absolutePath": "contracts/Options/OptionConfig.sol", "file": "../Options/OptionConfig.sol", "id": 9711, "nameLocation": "-1:-1:-1", "nodeType": "ImportDirective", "scope": 10207, "sourceUnit": 11466, "src": "551:37:19", "symbolAliases": [], "unitAlias": ""}, {"absolutePath": "contracts/Interfaces/Interfaces.sol", "file": "../Interfaces/Interfaces.sol", "id": 9712, "nameLocation": "-1:-1:-1", "nodeType": "ImportDirective", "scope": 10207, "sourceUnit": 18811, "src": "589:38:19", "symbolAliases": [], "unitAlias": ""}, {"absolutePath": "contracts/Pool/BufferIBFRPoolV2.sol", "file": "../Pool/BufferIBFRPoolV2.sol", "id": 9713, "nameLocation": "-1:-1:-1", "nodeType": "ImportDirective", "scope": 10207, "sourceUnit": 12691, "src": "628:38:19", "symbolAliases": [], "unitAlias": ""}, {"abstract": false, "baseContracts": [], "contractDependencies": [], "contractKind": "library", "fullyImplemented": true, "id": 10206, "linearizedBaseContracts": [10206], "name": "FeeCalculator", "nameLocation": "676:13:19", "nodeType": "ContractDefinition", "nodes": [{"body": {"id": 9751, "nodeType": "Block", "src": "1026:183:19", "statements": [{"assignments": [9725], "declarations": [{"constant": false, "id": 9725, "mutability": "mutable", "name": "poolBalance", "nameLocation": "1044:11:19", "nodeType": "VariableDeclaration", "scope": 9751, "src": "1036:19:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9724, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "1036:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "id": 9729, "initialValue": {"arguments": [], "expression": {"argumentTypes": [], "expression": {"id": 9726, "name": "pool", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9719, "src": "1058:4:19", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}}, "id": 9727, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "totalTokenXBalance", "nodeType": "MemberAccess", "referencedDeclaration": 12653, "src": "1058:23:19", "typeDescriptions": {"typeIdentifier": "t_function_external_view$__$returns$_t_uint256_$", "typeString": "function () view external returns (uint256)"}}, "id": 9728, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "1058:25:19", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "VariableDeclarationStatement", "src": "1036:47:19"}, {"expression": {"arguments": [{"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 9733, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"id": 9731, "name": "poolBalance", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9725, "src": "1101:11:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": ">", "rightExpression": {"hexValue": "30", "id": 9732, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "1115:1:19", "typeDescriptions": {"typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0"}, "value": "0"}, "src": "1101:15:19", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, {"hexValue": "4f38", "id": 9734, "isConstant": false, "isLValue": false, "isPure": true, "kind": "string", "lValueRequested": false, "nodeType": "Literal", "src": "1118:4:19", "typeDescriptions": {"typeIdentifier": "t_stringliteral_694eb040654db27d285bc1da6a2956b58ad679956ab6c2a13bdd9499d1faacb7", "typeString": "literal_string \"O8\""}, "value": "O8"}], "expression": {"argumentTypes": [{"typeIdentifier": "t_bool", "typeString": "bool"}, {"typeIdentifier": "t_stringliteral_694eb040654db27d285bc1da6a2956b58ad679956ab6c2a13bdd9499d1faacb7", "typeString": "literal_string \"O8\""}], "id": 9730, "name": "require", "nodeType": "Identifier", "overloadedDeclarations": [-18, -18], "referencedDeclaration": -18, "src": "1093:7:19", "typeDescriptions": {"typeIdentifier": "t_function_require_pure$_t_bool_$_t_string_memory_ptr_$returns$__$", "typeString": "function (bool,string memory) pure"}}, "id": 9735, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "1093:30:19", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_tuple$__$", "typeString": "tuple()"}}, "id": 9736, "nodeType": "ExpressionStatement", "src": "1093:30:19"}, {"expression": {"id": 9749, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 9737, "name": "utilization", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9722, "src": "1134:11:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 9748, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"components": [{"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 9745, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"components": [{"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 9742, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"arguments": [], "expression": {"argumentTypes": [], "expression": {"id": 9738, "name": "pool", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9719, "src": "1150:4:19", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}}, "id": 9739, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "lockedAmount", "nodeType": "MemberAccess", "referencedDeclaration": 11491, "src": "1150:17:19", "typeDescriptions": {"typeIdentifier": "t_function_external_view$__$returns$_t_uint256_$", "typeString": "function () view external returns (uint256)"}}, "id": 9740, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "1150:19:19", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": {"id": 9741, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9716, "src": "1172:6:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "1150:28:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "id": 9743, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "1149:30:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "*", "rightExpression": {"hexValue": "3130306538", "id": 9744, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "1182:5:19", "typeDescriptions": {"typeIdentifier": "t_rational_10000000000_by_1", "typeString": "int_const 10000000000"}, "value": "100e8"}, "src": "1149:38:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "id": 9746, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "1148:40:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "/", "rightExpression": {"id": 9747, "name": "poolBalance", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9725, "src": "1191:11:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "1148:54:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "1134:68:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 9750, "nodeType": "ExpressionStatement", "src": "1134:68:19"}]}, "documentation": {"id": 9714, "nodeType": "StructuredDocumentation", "src": "696:189:19", "text": " @notice Calculate the current Utilisation\n @param amount Option amount\n @param pool The pool selling the option\n @return utilization Current utilization"}, "functionSelector": "0cd5f90f", "id": 9752, "implemented": true, "kind": "function", "modifiers": [], "name": "getNewUtilisation", "nameLocation": "899:17:19", "nodeType": "FunctionDefinition", "parameters": {"id": 9720, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 9716, "mutability": "mutable", "name": "amount", "nameLocation": "925:6:19", "nodeType": "VariableDeclaration", "scope": 9752, "src": "917:14:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9715, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "917:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 9719, "mutability": "mutable", "name": "pool", "nameLocation": "950:4:19", "nodeType": "VariableDeclaration", "scope": 9752, "src": "933:21:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}, "typeName": {"id": 9718, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 9717, "name": "BufferIBFRPoolV2", "nodeType": "IdentifierPath", "referencedDeclaration": 12690, "src": "933:16:19"}, "referencedDeclaration": 12690, "src": "933:16:19", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}}, "visibility": "internal"}], "src": "916:39:19"}, "returnParameters": {"id": 9723, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 9722, "mutability": "mutable", "name": "utilization", "nameLocation": "1009:11:19", "nodeType": "VariableDeclaration", "scope": 9752, "src": "1001:19:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9721, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "1001:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "1000:21:19"}, "scope": 10206, "src": "890:319:19", "stateMutability": "view", "virtual": false, "visibility": "public"}, {"body": {"id": 9798, "nodeType": "Block", "src": "1690:226:19", "statements": [{"expression": {"id": 9770, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 9766, "name": "iv", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9764, "src": "1700:2:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"arguments": [], "expression": {"argumentTypes": [], "expression": {"id": 9767, "name": "config", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9761, "src": "1705:6:19", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}}, "id": 9768, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "impliedVolRate", "nodeType": "MemberAccess", "referencedDeclaration": 11106, "src": "1705:21:19", "typeDescriptions": {"typeIdentifier": "t_function_external_view$__$returns$_t_uint256_$", "typeString": "function () view external returns (uint256)"}}, "id": 9769, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "1705:23:19", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "1700:28:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 9771, "nodeType": "ExpressionStatement", "src": "1700:28:19"}, {"assignments": [9773], "declarations": [{"constant": false, "id": 9773, "mutability": "mutable", "name": "utilization", "nameLocation": "1746:11:19", "nodeType": "VariableDeclaration", "scope": 9798, "src": "1738:19:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9772, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "1738:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "id": 9778, "initialValue": {"arguments": [{"id": 9775, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9755, "src": "1778:6:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 9776, "name": "pool", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9758, "src": "1786:4:19", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}], "id": 9774, "name": "getNewUtilisation", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9752, "src": "1760:17:19", "typeDescriptions": {"typeIdentifier": "t_function_internal_view$_t_uint256_$_t_contract$_BufferIBFRPoolV2_$12690_$returns$_t_uint256_$", "typeString": "function (uint256,contract BufferIBFRPoolV2) view returns (uint256)"}}, "id": 9777, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "1760:31:19", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "VariableDeclarationStatement", "src": "1738:53:19"}, {"condition": {"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 9781, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"id": 9779, "name": "utilization", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9773, "src": "1805:11:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": ">", "rightExpression": {"hexValue": "34306538", "id": 9780, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "1819:4:19", "typeDescriptions": {"typeIdentifier": "t_rational_4000000000_by_1", "typeString": "int_const 4000000000"}, "value": "40e8"}, "src": "1805:18:19", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "id": 9797, "nodeType": "IfStatement", "src": "1801:109:19", "trueBody": {"id": 9796, "nodeType": "Block", "src": "1825:85:19", "statements": [{"expression": {"id": 9794, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 9782, "name": "iv", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9764, "src": "1839:2:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "+=", "rightHandSide": {"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 9793, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"components": [{"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 9788, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"id": 9783, "name": "iv", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9764, "src": "1846:2:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "*", "rightExpression": {"components": [{"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 9786, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"id": 9784, "name": "utilization", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9773, "src": "1852:11:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": {"hexValue": "34306538", "id": 9785, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "1866:4:19", "typeDescriptions": {"typeIdentifier": "t_rational_4000000000_by_1", "typeString": "int_const 4000000000"}, "value": "40e8"}, "src": "1852:18:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "id": 9787, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "1851:20:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "1846:25:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "id": 9789, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "1845:27:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "/", "rightExpression": {"arguments": [], "expression": {"argumentTypes": [], "expression": {"id": 9790, "name": "config", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9761, "src": "1875:6:19", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}}, "id": 9791, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "utilizationRate", "nodeType": "MemberAccess", "referencedDeclaration": 11129, "src": "1875:22:19", "typeDescriptions": {"typeIdentifier": "t_function_external_view$__$returns$_t_uint256_$", "typeString": "function () view external returns (uint256)"}}, "id": 9792, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "1875:24:19", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "1845:54:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "1839:60:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 9795, "nodeType": "ExpressionStatement", "src": "1839:60:19"}]}}]}, "documentation": {"id": 9753, "nodeType": "StructuredDocumentation", "src": "1215:313:19", "text": " @notice Calculate the Utilisation adjusted ImpliedVol for the pool according to https://www.desmos.com/calculator/xdmhn97opd\n @param amount Option amount\n @param pool The pool selling the option\n @param config The option configuration\n @return iv The adjusted ImpliedVol"}, "functionSelector": "ce460184", "id": 9799, "implemented": true, "kind": "function", "modifiers": [], "name": "currentImpliedVolatility", "nameLocation": "1542:24:19", "nodeType": "FunctionDefinition", "parameters": {"id": 9762, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 9755, "mutability": "mutable", "name": "amount", "nameLocation": "1584:6:19", "nodeType": "VariableDeclaration", "scope": 9799, "src": "1576:14:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9754, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "1576:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 9758, "mutability": "mutable", "name": "pool", "nameLocation": "1617:4:19", "nodeType": "VariableDeclaration", "scope": 9799, "src": "1600:21:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}, "typeName": {"id": 9757, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 9756, "name": "BufferIBFRPoolV2", "nodeType": "IdentifierPath", "referencedDeclaration": 12690, "src": "1600:16:19"}, "referencedDeclaration": 12690, "src": "1600:16:19", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}}, "visibility": "internal"}, {"constant": false, "id": 9761, "mutability": "mutable", "name": "config", "nameLocation": "1644:6:19", "nodeType": "VariableDeclaration", "scope": 9799, "src": "1631:19:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}, "typeName": {"id": 9760, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 9759, "name": "OptionConfig", "nodeType": "IdentifierPath", "referencedDeclaration": 11465, "src": "1631:12:19"}, "referencedDeclaration": 11465, "src": "1631:12:19", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}}, "visibility": "internal"}], "src": "1566:90:19"}, "returnParameters": {"id": 9765, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 9764, "mutability": "mutable", "name": "iv", "nameLocation": "1686:2:19", "nodeType": "VariableDeclaration", "scope": 9799, "src": "1678:10:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9763, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "1678:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "1677:12:19"}, "scope": 10206, "src": "1533:383:19", "stateMutability": "view", "virtual": false, "visibility": "public"}, {"body": {"id": 9867, "nodeType": "Block", "src": "2949:482:19", "statements": [{"assignments": [9827], "declarations": [{"constant": false, "id": 9827, "mutability": "mutable", "name": "usdPremium", "nameLocation": "3034:10:19", "nodeType": "VariableDeclaration", "scope": 9867, "src": "3026:18:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9826, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "3026:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "id": 9844, "initialValue": {"arguments": [{"arguments": [{"id": 9831, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9804, "src": "3114:6:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 9832, "name": "pool", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9817, "src": "3122:4:19", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}}, {"id": 9833, "name": "config", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9814, "src": "3128:6:19", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}, {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}], "id": 9830, "name": "currentImpliedVolatility", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9799, "src": "3089:24:19", "typeDescriptions": {"typeIdentifier": "t_function_internal_view$_t_uint256_$_t_contract$_BufferIBFRPoolV2_$12690_$_t_contract$_OptionConfig_$11465_$returns$_t_uint256_$", "typeString": "function (uint256,contract BufferIBFRPoolV2,contract OptionConfig) view returns (uint256)"}}, "id": 9834, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "3089:46:19", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 9835, "name": "strike", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9806, "src": "3149:6:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 9836, "name": "currentPrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9811, "src": "3169:12:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 9837, "name": "period", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9802, "src": "3195:6:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"commonType": {"typeIdentifier": "t_enum$_OptionType_$18452", "typeString": "enum IBufferOptions.OptionType"}, "id": 9842, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"id": 9838, "name": "optionType", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9809, "src": "3215:10:19", "typeDescriptions": {"typeIdentifier": "t_enum$_OptionType_$18452", "typeString": "enum IBufferOptions.OptionType"}}, "nodeType": "BinaryOperation", "operator": "==", "rightExpression": {"expression": {"expression": {"id": 9839, "name": "IBufferOptions", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18557, "src": "3229:14:19", "typeDescriptions": {"typeIdentifier": "t_type$_t_contract$_IBufferOptions_$18557_$", "typeString": "type(contract IBufferOptions)"}}, "id": 9840, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "OptionType", "nodeType": "MemberAccess", "referencedDeclaration": 18452, "src": "3229:25:19", "typeDescriptions": {"typeIdentifier": "t_type$_t_enum$_OptionType_$18452_$", "typeString": "type(enum IBufferOptions.OptionType)"}}, "id": 9841, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "memberName": "Call", "nodeType": "MemberAccess", "referencedDeclaration": 18451, "src": "3229:30:19", "typeDescriptions": {"typeIdentifier": "t_enum$_OptionType_$18452", "typeString": "enum IBufferOptions.OptionType"}}, "src": "3215:44:19", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_bool", "typeString": "bool"}], "expression": {"id": 9828, "name": "OptionMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22206, "src": "3047:10:19", "typeDescriptions": {"typeIdentifier": "t_type$_t_contract$_OptionMath_$22206_$", "typeString": "type(library OptionMath)"}}, "id": 9829, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "blackScholesPrice", "nodeType": "MemberAccess", "referencedDeclaration": 21910, "src": "3047:28:19", "typeDescriptions": {"typeIdentifier": "t_function_delegatecall_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_bool_$returns$_t_uint256_$", "typeString": "function (uint256,uint256,uint256,uint256,bool) pure returns (uint256)"}}, "id": 9843, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "3047:222:19", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "VariableDeclarationStatement", "src": "3026:243:19"}, {"expression": {"id": 9852, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 9845, "name": "premium", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9824, "src": "3279:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 9851, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"components": [{"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 9848, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"id": 9846, "name": "usdPremium", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9827, "src": "3290:10:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "*", "rightExpression": {"id": 9847, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9804, "src": "3303:6:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "3290:19:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "id": 9849, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "3289:21:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "/", "rightExpression": {"id": 9850, "name": "currentPrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9811, "src": "3313:12:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "3289:36:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "3279:46:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 9853, "nodeType": "ExpressionStatement", "src": "3279:46:19"}, {"expression": {"id": 9859, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 9854, "name": "settlementFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9822, "src": "3335:13:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"arguments": [{"id": 9856, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9804, "src": "3368:6:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 9857, "name": "config", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9814, "src": "3376:6:19", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}], "id": 9855, "name": "getSettlementFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10106, "src": "3351:16:19", "typeDescriptions": {"typeIdentifier": "t_function_internal_view$_t_uint256_$_t_contract$_OptionConfig_$11465_$returns$_t_uint256_$", "typeString": "function (uint256,contract OptionConfig) view returns (uint256)"}}, "id": 9858, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "3351:32:19", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "3335:48:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 9860, "nodeType": "ExpressionStatement", "src": "3335:48:19"}, {"expression": {"id": 9865, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 9861, "name": "total", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9820, "src": "3393:5:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 9864, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"id": 9862, "name": "settlementFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9822, "src": "3401:13:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": {"id": 9863, "name": "premium", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9824, "src": "3417:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "3401:23:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "3393:31:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 9866, "nodeType": "ExpressionStatement", "src": "3393:31:19"}]}, "documentation": {"id": 9800, "nodeType": "StructuredDocumentation", "src": "1922:644:19", "text": " @notice Used for getting the price for Options in tokenX\n @param period Option period in seconds (1 days <= period <= 4 weeks)\n @param amount Option amount\n @param strike Strike price of the option\n @param optionType Type of the Option\n @param currentPrice Current price of the underlying asset\n @param config The option configuration\n @param pool The pool selling the option\n @return total Total price to be paid\n @return settlementFee Amount to be distributed to the Buffer token holders\n @return premium Amount that covers the price difference in the ITM options"}, "functionSelector": "27150148", "id": 9868, "implemented": true, "kind": "function", "modifiers": [], "name": "fees", "nameLocation": "2580:4:19", "nodeType": "FunctionDefinition", "parameters": {"id": 9818, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 9802, "mutability": "mutable", "name": "period", "nameLocation": "2602:6:19", "nodeType": "VariableDeclaration", "scope": 9868, "src": "2594:14:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9801, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "2594:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 9804, "mutability": "mutable", "name": "amount", "nameLocation": "2626:6:19", "nodeType": "VariableDeclaration", "scope": 9868, "src": "2618:14:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9803, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "2618:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 9806, "mutability": "mutable", "name": "strike", "nameLocation": "2650:6:19", "nodeType": "VariableDeclaration", "scope": 9868, "src": "2642:14:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9805, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "2642:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 9809, "mutability": "mutable", "name": "optionType", "nameLocation": "2692:10:19", "nodeType": "VariableDeclaration", "scope": 9868, "src": "2666:36:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_enum$_OptionType_$18452", "typeString": "enum IBufferOptions.OptionType"}, "typeName": {"id": 9808, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 9807, "name": "IBufferOptions.OptionType", "nodeType": "IdentifierPath", "referencedDeclaration": 18452, "src": "2666:25:19"}, "referencedDeclaration": 18452, "src": "2666:25:19", "typeDescriptions": {"typeIdentifier": "t_enum$_OptionType_$18452", "typeString": "enum IBufferOptions.OptionType"}}, "visibility": "internal"}, {"constant": false, "id": 9811, "mutability": "mutable", "name": "currentPrice", "nameLocation": "2720:12:19", "nodeType": "VariableDeclaration", "scope": 9868, "src": "2712:20:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9810, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "2712:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 9814, "mutability": "mutable", "name": "config", "nameLocation": "2755:6:19", "nodeType": "VariableDeclaration", "scope": 9868, "src": "2742:19:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}, "typeName": {"id": 9813, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 9812, "name": "OptionConfig", "nodeType": "IdentifierPath", "referencedDeclaration": 11465, "src": "2742:12:19"}, "referencedDeclaration": 11465, "src": "2742:12:19", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}}, "visibility": "internal"}, {"constant": false, "id": 9817, "mutability": "mutable", "name": "pool", "nameLocation": "2788:4:19", "nodeType": "VariableDeclaration", "scope": 9868, "src": "2771:21:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}, "typeName": {"id": 9816, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 9815, "name": "BufferIBFRPoolV2", "nodeType": "IdentifierPath", "referencedDeclaration": 12690, "src": "2771:16:19"}, "referencedDeclaration": 12690, "src": "2771:16:19", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}}, "visibility": "internal"}], "src": "2584:214:19"}, "returnParameters": {"id": 9825, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 9820, "mutability": "mutable", "name": "total", "nameLocation": "2865:5:19", "nodeType": "VariableDeclaration", "scope": 9868, "src": "2857:13:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9819, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "2857:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 9822, "mutability": "mutable", "name": "settlementFee", "nameLocation": "2892:13:19", "nodeType": "VariableDeclaration", "scope": 9868, "src": "2884:21:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9821, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "2884:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 9824, "mutability": "mutable", "name": "premium", "nameLocation": "2927:7:19", "nodeType": "VariableDeclaration", "scope": 9868, "src": "2919:15:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9823, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "2919:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "2843:101:19"}, "scope": 10206, "src": "2571:860:19", "stateMutability": "view", "virtual": false, "visibility": "public"}, {"body": {"id": 9936, "nodeType": "Block", "src": "4485:488:19", "statements": [{"assignments": [9896], "declarations": [{"constant": false, "id": 9896, "mutability": "mutable", "name": "usdPremium", "nameLocation": "4576:10:19", "nodeType": "VariableDeclaration", "scope": 9936, "src": "4568:18:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9895, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "4568:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "id": 9913, "initialValue": {"arguments": [{"arguments": [{"id": 9900, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9873, "src": "4656:6:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 9901, "name": "pool", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9886, "src": "4664:4:19", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}}, {"id": 9902, "name": "config", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9883, "src": "4670:6:19", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}, {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}], "id": 9899, "name": "currentImpliedVolatility", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9799, "src": "4631:24:19", "typeDescriptions": {"typeIdentifier": "t_function_internal_view$_t_uint256_$_t_contract$_BufferIBFRPoolV2_$12690_$_t_contract$_OptionConfig_$11465_$returns$_t_uint256_$", "typeString": "function (uint256,contract BufferIBFRPoolV2,contract OptionConfig) view returns (uint256)"}}, "id": 9903, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "4631:46:19", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 9904, "name": "strike", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9875, "src": "4691:6:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 9905, "name": "currentPrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9880, "src": "4711:12:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 9906, "name": "period", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9871, "src": "4737:6:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"commonType": {"typeIdentifier": "t_enum$_OptionType_$18452", "typeString": "enum IBufferOptions.OptionType"}, "id": 9911, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"id": 9907, "name": "optionType", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9878, "src": "4757:10:19", "typeDescriptions": {"typeIdentifier": "t_enum$_OptionType_$18452", "typeString": "enum IBufferOptions.OptionType"}}, "nodeType": "BinaryOperation", "operator": "==", "rightExpression": {"expression": {"expression": {"id": 9908, "name": "IBufferOptions", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18557, "src": "4771:14:19", "typeDescriptions": {"typeIdentifier": "t_type$_t_contract$_IBufferOptions_$18557_$", "typeString": "type(contract IBufferOptions)"}}, "id": 9909, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "OptionType", "nodeType": "MemberAccess", "referencedDeclaration": 18452, "src": "4771:25:19", "typeDescriptions": {"typeIdentifier": "t_type$_t_enum$_OptionType_$18452_$", "typeString": "type(enum IBufferOptions.OptionType)"}}, "id": 9910, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "memberName": "Call", "nodeType": "MemberAccess", "referencedDeclaration": 18451, "src": "4771:30:19", "typeDescriptions": {"typeIdentifier": "t_enum$_OptionType_$18452", "typeString": "enum IBufferOptions.OptionType"}}, "src": "4757:44:19", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_bool", "typeString": "bool"}], "expression": {"id": 9897, "name": "OptionMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22206, "src": "4589:10:19", "typeDescriptions": {"typeIdentifier": "t_type$_t_contract$_OptionMath_$22206_$", "typeString": "type(library OptionMath)"}}, "id": 9898, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "blackScholesPrice", "nodeType": "MemberAccess", "referencedDeclaration": 21910, "src": "4589:28:19", "typeDescriptions": {"typeIdentifier": "t_function_delegatecall_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_bool_$returns$_t_uint256_$", "typeString": "function (uint256,uint256,uint256,uint256,bool) pure returns (uint256)"}}, "id": 9912, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "4589:222:19", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "VariableDeclarationStatement", "src": "4568:243:19"}, {"expression": {"id": 9919, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 9914, "name": "settlementFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9891, "src": "4821:13:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"arguments": [{"id": 9916, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9873, "src": "4854:6:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 9917, "name": "config", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9883, "src": "4862:6:19", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}], "id": 9915, "name": "getSettlementFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10106, "src": "4837:16:19", "typeDescriptions": {"typeIdentifier": "t_function_internal_view$_t_uint256_$_t_contract$_OptionConfig_$11465_$returns$_t_uint256_$", "typeString": "function (uint256,contract OptionConfig) view returns (uint256)"}}, "id": 9918, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "4837:32:19", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "4821:48:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 9920, "nodeType": "ExpressionStatement", "src": "4821:48:19"}, {"expression": {"id": 9928, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 9921, "name": "premium", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9893, "src": "4879:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 9927, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"components": [{"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 9924, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"id": 9922, "name": "usdPremium", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9896, "src": "4890:10:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "*", "rightExpression": {"id": 9923, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9873, "src": "4903:6:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "4890:19:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "id": 9925, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "4889:21:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "/", "rightExpression": {"id": 9926, "name": "currentPrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9880, "src": "4913:12:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "4889:36:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "4879:46:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 9929, "nodeType": "ExpressionStatement", "src": "4879:46:19"}, {"expression": {"id": 9934, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 9930, "name": "total", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9889, "src": "4935:5:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 9933, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"id": 9931, "name": "settlementFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9891, "src": "4943:13:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": {"id": 9932, "name": "premium", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9893, "src": "4959:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "4943:23:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "4935:31:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 9935, "nodeType": "ExpressionStatement", "src": "4935:31:19"}]}, "documentation": {"id": 9869, "nodeType": "StructuredDocumentation", "src": "3437:662:19", "text": " @notice Used for getting the price for Options in USD\n @param period Option period in seconds (1 days <= period <= 4 weeks)\n @param amount Option amount\n @param strike Strike price of the option\n @param optionType Type of the Option\n @param currentPrice Current price of the underlying asset\n @param config The option configuration\n @param pool The pool selling the option\n @return total Total price to be paid in USD\n @return settlementFee Amount to be distributed to the Buffer token holders in USD\n @return premium Amount that covers the price difference in the ITM options in USD"}, "functionSelector": "c4653f31", "id": 9937, "implemented": true, "kind": "function", "modifiers": [], "name": "feesUsd", "nameLocation": "4113:7:19", "nodeType": "FunctionDefinition", "parameters": {"id": 9887, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 9871, "mutability": "mutable", "name": "period", "nameLocation": "4138:6:19", "nodeType": "VariableDeclaration", "scope": 9937, "src": "4130:14:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9870, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "4130:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 9873, "mutability": "mutable", "name": "amount", "nameLocation": "4162:6:19", "nodeType": "VariableDeclaration", "scope": 9937, "src": "4154:14:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9872, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "4154:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 9875, "mutability": "mutable", "name": "strike", "nameLocation": "4186:6:19", "nodeType": "VariableDeclaration", "scope": 9937, "src": "4178:14:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9874, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "4178:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 9878, "mutability": "mutable", "name": "optionType", "nameLocation": "4228:10:19", "nodeType": "VariableDeclaration", "scope": 9937, "src": "4202:36:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_enum$_OptionType_$18452", "typeString": "enum IBufferOptions.OptionType"}, "typeName": {"id": 9877, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 9876, "name": "IBufferOptions.OptionType", "nodeType": "IdentifierPath", "referencedDeclaration": 18452, "src": "4202:25:19"}, "referencedDeclaration": 18452, "src": "4202:25:19", "typeDescriptions": {"typeIdentifier": "t_enum$_OptionType_$18452", "typeString": "enum IBufferOptions.OptionType"}}, "visibility": "internal"}, {"constant": false, "id": 9880, "mutability": "mutable", "name": "currentPrice", "nameLocation": "4256:12:19", "nodeType": "VariableDeclaration", "scope": 9937, "src": "4248:20:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9879, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "4248:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 9883, "mutability": "mutable", "name": "config", "nameLocation": "4291:6:19", "nodeType": "VariableDeclaration", "scope": 9937, "src": "4278:19:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}, "typeName": {"id": 9882, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 9881, "name": "OptionConfig", "nodeType": "IdentifierPath", "referencedDeclaration": 11465, "src": "4278:12:19"}, "referencedDeclaration": 11465, "src": "4278:12:19", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}}, "visibility": "internal"}, {"constant": false, "id": 9886, "mutability": "mutable", "name": "pool", "nameLocation": "4324:4:19", "nodeType": "VariableDeclaration", "scope": 9937, "src": "4307:21:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}, "typeName": {"id": 9885, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 9884, "name": "BufferIBFRPoolV2", "nodeType": "IdentifierPath", "referencedDeclaration": 12690, "src": "4307:16:19"}, "referencedDeclaration": 12690, "src": "4307:16:19", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}}, "visibility": "internal"}], "src": "4120:214:19"}, "returnParameters": {"id": 9894, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 9889, "mutability": "mutable", "name": "total", "nameLocation": "4401:5:19", "nodeType": "VariableDeclaration", "scope": 9937, "src": "4393:13:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9888, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "4393:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 9891, "mutability": "mutable", "name": "settlementFee", "nameLocation": "4428:13:19", "nodeType": "VariableDeclaration", "scope": 9937, "src": "4420:21:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9890, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "4420:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 9893, "mutability": "mutable", "name": "premium", "nameLocation": "4463:7:19", "nodeType": "VariableDeclaration", "scope": 9937, "src": "4455:15:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9892, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "4455:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "4379:101:19"}, "scope": 10206, "src": "4104:869:19", "stateMutability": "view", "virtual": false, "visibility": "public"}, {"body": {"id": 9981, "nodeType": "Block", "src": "5910:252:19", "statements": [{"expression": {"id": 9979, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 9961, "name": "premium", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9959, "src": "5920:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 9978, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 9976, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"arguments": [{"arguments": [{"id": 9965, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9942, "src": "6003:6:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 9966, "name": "pool", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9956, "src": "6011:4:19", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}}, {"id": 9967, "name": "config", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9953, "src": "6017:6:19", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}, {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}], "id": 9964, "name": "currentImpliedVolatility", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9799, "src": "5978:24:19", "typeDescriptions": {"typeIdentifier": "t_function_internal_view$_t_uint256_$_t_contract$_BufferIBFRPoolV2_$12690_$_t_contract$_OptionConfig_$11465_$returns$_t_uint256_$", "typeString": "function (uint256,contract BufferIBFRPoolV2,contract OptionConfig) view returns (uint256)"}}, "id": 9968, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "5978:46:19", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 9969, "name": "strike", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9944, "src": "6038:6:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 9970, "name": "currentPrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9950, "src": "6058:12:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 9971, "name": "period", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9940, "src": "6084:6:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 9972, "name": "isYes", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9946, "src": "6104:5:19", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, {"id": 9973, "name": "isAbove", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9948, "src": "6123:7:19", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_bool", "typeString": "bool"}, {"typeIdentifier": "t_bool", "typeString": "bool"}], "expression": {"id": 9962, "name": "OptionMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22206, "src": "5930:10:19", "typeDescriptions": {"typeIdentifier": "t_type$_t_contract$_OptionMath_$22206_$", "typeString": "type(library OptionMath)"}}, "id": 9963, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "blackScholesPriceBinary", "nodeType": "MemberAccess", "referencedDeclaration": 22107, "src": "5930:34:19", "typeDescriptions": {"typeIdentifier": "t_function_delegatecall_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_bool_$_t_bool_$returns$_t_uint256_$", "typeString": "function (uint256,uint256,uint256,uint256,bool,bool) pure returns (uint256)"}}, "id": 9974, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "5930:210:19", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "*", "rightExpression": {"id": 9975, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9942, "src": "6143:6:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "5930:219:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "/", "rightExpression": {"hexValue": "316538", "id": 9977, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "6152:3:19", "typeDescriptions": {"typeIdentifier": "t_rational_100000000_by_1", "typeString": "int_const 100000000"}, "value": "1e8"}, "src": "5930:225:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "5920:235:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 9980, "nodeType": "ExpressionStatement", "src": "5920:235:19"}]}, "documentation": {"id": 9938, "nodeType": "StructuredDocumentation", "src": "4979:600:19", "text": " @notice Used for getting the price for Binary Options\n @param period Option period in seconds (1 days <= period <= 4 weeks)\n @param amount Option amount\n @param strike Strike price of the option\n @param isYes whether the option isAbove or not\n @param isAbove whether the price will stay above this strike or not\n @param currentPrice Current price of the underlying asset\n @param config The option configuration\n @param pool The pool selling the option\n @return premium Amount that covers the price difference in the ITM options"}, "functionSelector": "e39d06e9", "id": 9982, "implemented": true, "kind": "function", "modifiers": [], "name": "feesTokenXBinary", "nameLocation": "5593:16:19", "nodeType": "FunctionDefinition", "parameters": {"id": 9957, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 9940, "mutability": "mutable", "name": "period", "nameLocation": "5627:6:19", "nodeType": "VariableDeclaration", "scope": 9982, "src": "5619:14:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9939, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "5619:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 9942, "mutability": "mutable", "name": "amount", "nameLocation": "5651:6:19", "nodeType": "VariableDeclaration", "scope": 9982, "src": "5643:14:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9941, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "5643:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 9944, "mutability": "mutable", "name": "strike", "nameLocation": "5675:6:19", "nodeType": "VariableDeclaration", "scope": 9982, "src": "5667:14:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9943, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "5667:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 9946, "mutability": "mutable", "name": "isYes", "nameLocation": "5696:5:19", "nodeType": "VariableDeclaration", "scope": 9982, "src": "5691:10:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}, "typeName": {"id": 9945, "name": "bool", "nodeType": "ElementaryTypeName", "src": "5691:4:19", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "visibility": "internal"}, {"constant": false, "id": 9948, "mutability": "mutable", "name": "isAbove", "nameLocation": "5716:7:19", "nodeType": "VariableDeclaration", "scope": 9982, "src": "5711:12:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}, "typeName": {"id": 9947, "name": "bool", "nodeType": "ElementaryTypeName", "src": "5711:4:19", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "visibility": "internal"}, {"constant": false, "id": 9950, "mutability": "mutable", "name": "currentPrice", "nameLocation": "5741:12:19", "nodeType": "VariableDeclaration", "scope": 9982, "src": "5733:20:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9949, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "5733:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 9953, "mutability": "mutable", "name": "config", "nameLocation": "5776:6:19", "nodeType": "VariableDeclaration", "scope": 9982, "src": "5763:19:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}, "typeName": {"id": 9952, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 9951, "name": "OptionConfig", "nodeType": "IdentifierPath", "referencedDeclaration": 11465, "src": "5763:12:19"}, "referencedDeclaration": 11465, "src": "5763:12:19", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}}, "visibility": "internal"}, {"constant": false, "id": 9956, "mutability": "mutable", "name": "pool", "nameLocation": "5809:4:19", "nodeType": "VariableDeclaration", "scope": 9982, "src": "5792:21:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}, "typeName": {"id": 9955, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 9954, "name": "BufferIBFRPoolV2", "nodeType": "IdentifierPath", "referencedDeclaration": 12690, "src": "5792:16:19"}, "referencedDeclaration": 12690, "src": "5792:16:19", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}}, "visibility": "internal"}], "src": "5609:210:19"}, "returnParameters": {"id": 9960, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 9959, "mutability": "mutable", "name": "premium", "nameLocation": "5888:7:19", "nodeType": "VariableDeclaration", "scope": 9982, "src": "5880:15:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9958, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "5880:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "5866:39:19"}, "scope": 10206, "src": "5584:578:19", "stateMutability": "view", "virtual": false, "visibility": "external"}, {"body": {"id": 10036, "nodeType": "Block", "src": "7282:310:19", "statements": [{"expression": {"id": 10021, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 10010, "name": "premium", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10008, "src": "7292:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"arguments": [{"id": 10012, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9987, "src": "7326:6:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 10013, "name": "pool", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10001, "src": "7346:4:19", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}}, {"id": 10014, "name": "config", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9998, "src": "7364:6:19", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}}, {"id": 10015, "name": "strike", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9989, "src": "7384:6:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 10016, "name": "period", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9985, "src": "7404:6:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 10017, "name": "currentPrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9995, "src": "7424:12:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 10018, "name": "isYes", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9991, "src": "7450:5:19", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, {"id": 10019, "name": "isAbove", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9993, "src": "7469:7:19", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}, {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_bool", "typeString": "bool"}, {"typeIdentifier": "t_bool", "typeString": "bool"}], "id": 10011, "name": "getPremium", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10155, "src": "7302:10:19", "typeDescriptions": {"typeIdentifier": "t_function_internal_view$_t_uint256_$_t_contract$_BufferIBFRPoolV2_$12690_$_t_contract$_OptionConfig_$11465_$_t_uint256_$_t_uint256_$_t_uint256_$_t_bool_$_t_bool_$returns$_t_uint256_$", "typeString": "function (uint256,contract BufferIBFRPoolV2,contract OptionConfig,uint256,uint256,uint256,bool,bool) view returns (uint256)"}}, "id": 10020, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "7302:184:19", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "7292:194:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 10022, "nodeType": "ExpressionStatement", "src": "7292:194:19"}, {"expression": {"id": 10028, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 10023, "name": "settlementFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10006, "src": "7496:13:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"arguments": [{"id": 10025, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9987, "src": "7529:6:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 10026, "name": "config", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9998, "src": "7537:6:19", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}], "id": 10024, "name": "getSettlementFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10106, "src": "7512:16:19", "typeDescriptions": {"typeIdentifier": "t_function_internal_view$_t_uint256_$_t_contract$_OptionConfig_$11465_$returns$_t_uint256_$", "typeString": "function (uint256,contract OptionConfig) view returns (uint256)"}}, "id": 10027, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "7512:32:19", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "7496:48:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 10029, "nodeType": "ExpressionStatement", "src": "7496:48:19"}, {"expression": {"id": 10034, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 10030, "name": "total", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10004, "src": "7554:5:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 10033, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"id": 10031, "name": "settlementFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10006, "src": "7562:13:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": {"id": 10032, "name": "premium", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10008, "src": "7578:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "7562:23:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "7554:31:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 10035, "nodeType": "ExpressionStatement", "src": "7554:31:19"}]}, "documentation": {"id": 9983, "nodeType": "StructuredDocumentation", "src": "6169:726:19", "text": " @notice Used for getting the price for Binary Options\n @param period Option period in seconds (1 days <= period <= 4 weeks)\n @param amount Option amount\n @param strike Strike price of the option\n @param isYes whether the option isAbove or not\n @param isAbove whether the price will stay above this strike or not\n @param currentPrice Current price of the underlying asset\n @param config The option configuration\n @param pool The pool selling the option\n @return total Total price to be paid\n @return settlementFee Amount to be distributed to the Buffer token holders\n @return premium Amount that covers the price difference in the ITM options"}, "functionSelector": "d13a79bc", "id": 10037, "implemented": true, "kind": "function", "modifiers": [], "name": "feesBinary", "nameLocation": "6909:10:19", "nodeType": "FunctionDefinition", "parameters": {"id": 10002, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 9985, "mutability": "mutable", "name": "period", "nameLocation": "6937:6:19", "nodeType": "VariableDeclaration", "scope": 10037, "src": "6929:14:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9984, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "6929:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 9987, "mutability": "mutable", "name": "amount", "nameLocation": "6961:6:19", "nodeType": "VariableDeclaration", "scope": 10037, "src": "6953:14:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9986, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "6953:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 9989, "mutability": "mutable", "name": "strike", "nameLocation": "6985:6:19", "nodeType": "VariableDeclaration", "scope": 10037, "src": "6977:14:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9988, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "6977:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 9991, "mutability": "mutable", "name": "isYes", "nameLocation": "7006:5:19", "nodeType": "VariableDeclaration", "scope": 10037, "src": "7001:10:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}, "typeName": {"id": 9990, "name": "bool", "nodeType": "ElementaryTypeName", "src": "7001:4:19", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "visibility": "internal"}, {"constant": false, "id": 9993, "mutability": "mutable", "name": "isAbove", "nameLocation": "7026:7:19", "nodeType": "VariableDeclaration", "scope": 10037, "src": "7021:12:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}, "typeName": {"id": 9992, "name": "bool", "nodeType": "ElementaryTypeName", "src": "7021:4:19", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "visibility": "internal"}, {"constant": false, "id": 9995, "mutability": "mutable", "name": "currentPrice", "nameLocation": "7051:12:19", "nodeType": "VariableDeclaration", "scope": 10037, "src": "7043:20:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 9994, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7043:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 9998, "mutability": "mutable", "name": "config", "nameLocation": "7086:6:19", "nodeType": "VariableDeclaration", "scope": 10037, "src": "7073:19:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}, "typeName": {"id": 9997, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 9996, "name": "OptionConfig", "nodeType": "IdentifierPath", "referencedDeclaration": 11465, "src": "7073:12:19"}, "referencedDeclaration": 11465, "src": "7073:12:19", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}}, "visibility": "internal"}, {"constant": false, "id": 10001, "mutability": "mutable", "name": "pool", "nameLocation": "7119:4:19", "nodeType": "VariableDeclaration", "scope": 10037, "src": "7102:21:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}, "typeName": {"id": 10000, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 9999, "name": "BufferIBFRPoolV2", "nodeType": "IdentifierPath", "referencedDeclaration": 12690, "src": "7102:16:19"}, "referencedDeclaration": 12690, "src": "7102:16:19", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}}, "visibility": "internal"}], "src": "6919:210:19"}, "returnParameters": {"id": 10009, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 10004, "mutability": "mutable", "name": "total", "nameLocation": "7198:5:19", "nodeType": "VariableDeclaration", "scope": 10037, "src": "7190:13:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 10003, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7190:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 10006, "mutability": "mutable", "name": "settlementFee", "nameLocation": "7225:13:19", "nodeType": "VariableDeclaration", "scope": 10037, "src": "7217:21:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 10005, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7217:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 10008, "mutability": "mutable", "name": "premium", "nameLocation": "7260:7:19", "nodeType": "VariableDeclaration", "scope": 10037, "src": "7252:15:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 10007, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7252:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "7176:101:19"}, "scope": 10206, "src": "6900:692:19", "stateMutability": "view", "virtual": false, "visibility": "external"}, {"body": {"id": 10084, "nodeType": "Block", "src": "8463:274:19", "statements": [{"expression": {"id": 10068, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 10060, "name": "premium", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10058, "src": "8473:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"arguments": [{"id": 10062, "name": "optionDetails", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10041, "src": "8513:13:19", "typeDescriptions": {"typeIdentifier": "t_struct$_OptionDetails_$18516_memory_ptr", "typeString": "struct IBufferOptions.OptionDetails memory"}}, {"id": 10063, "name": "pool", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10051, "src": "8540:4:19", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}}, {"id": 10064, "name": "config", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10048, "src": "8558:6:19", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}}, {"id": 10065, "name": "currentPrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10043, "src": "8578:12:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 10066, "name": "KPI", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10045, "src": "8604:3:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_struct$_OptionDetails_$18516_memory_ptr", "typeString": "struct IBufferOptions.OptionDetails memory"}, {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}, {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}], "id": 10061, "name": "getPremiumBinary", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10205, "src": "8483:16:19", "typeDescriptions": {"typeIdentifier": "t_function_internal_view$_t_struct$_OptionDetails_$18516_memory_ptr_$_t_contract$_BufferIBFRPoolV2_$12690_$_t_contract$_OptionConfig_$11465_$_t_uint256_$_t_uint256_$returns$_t_uint256_$", "typeString": "function (struct IBufferOptions.OptionDetails memory,contract BufferIBFRPoolV2,contract OptionConfig,uint256,uint256) view returns (uint256)"}}, "id": 10067, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "8483:134:19", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "8473:144:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 10069, "nodeType": "ExpressionStatement", "src": "8473:144:19"}, {"expression": {"id": 10076, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 10070, "name": "settlementFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10056, "src": "8627:13:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"arguments": [{"expression": {"id": 10072, "name": "optionDetails", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10041, "src": "8660:13:19", "typeDescriptions": {"typeIdentifier": "t_struct$_OptionDetails_$18516_memory_ptr", "typeString": "struct IBufferOptions.OptionDetails memory"}}, "id": 10073, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberName": "amount", "nodeType": "MemberAccess", "referencedDeclaration": 18509, "src": "8660:20:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 10074, "name": "config", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10048, "src": "8682:6:19", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}], "id": 10071, "name": "getSettlementFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10106, "src": "8643:16:19", "typeDescriptions": {"typeIdentifier": "t_function_internal_view$_t_uint256_$_t_contract$_OptionConfig_$11465_$returns$_t_uint256_$", "typeString": "function (uint256,contract OptionConfig) view returns (uint256)"}}, "id": 10075, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "8643:46:19", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "8627:62:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 10077, "nodeType": "ExpressionStatement", "src": "8627:62:19"}, {"expression": {"id": 10082, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 10078, "name": "total", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10054, "src": "8699:5:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 10081, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"id": 10079, "name": "settlementFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10056, "src": "8707:13:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": {"id": 10080, "name": "premium", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10058, "src": "8723:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "8707:23:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "8699:31:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 10083, "nodeType": "ExpressionStatement", "src": "8699:31:19"}]}, "documentation": {"id": 10038, "nodeType": "StructuredDocumentation", "src": "7598:509:19", "text": " @notice Used for getting the price for Binary KPI Options\n @param optionDetails Details of the option to be priced\n @param currentPrice Current price of the tokenX\n @param KPI KPI value for option\n @param config Option config\n @param pool pool contract\n @return total Total price to be paid\n @return settlementFee Amount to be distributed to the Buffer token holders\n @return premium Amount that covers the price difference in the ITM options"}, "functionSelector": "0e04d1bc", "id": 10085, "implemented": true, "kind": "function", "modifiers": [], "name": "feesKPIBinary", "nameLocation": "8121:13:19", "nodeType": "FunctionDefinition", "parameters": {"id": 10052, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 10041, "mutability": "mutable", "name": "optionDetails", "nameLocation": "8180:13:19", "nodeType": "VariableDeclaration", "scope": 10085, "src": "8144:49:19", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": {"typeIdentifier": "t_struct$_OptionDetails_$18516_memory_ptr", "typeString": "struct IBufferOptions.OptionDetails"}, "typeName": {"id": 10040, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 10039, "name": "IBufferOptions.OptionDetails", "nodeType": "IdentifierPath", "referencedDeclaration": 18516, "src": "8144:28:19"}, "referencedDeclaration": 18516, "src": "8144:28:19", "typeDescriptions": {"typeIdentifier": "t_struct$_OptionDetails_$18516_storage_ptr", "typeString": "struct IBufferOptions.OptionDetails"}}, "visibility": "internal"}, {"constant": false, "id": 10043, "mutability": "mutable", "name": "currentPrice", "nameLocation": "8211:12:19", "nodeType": "VariableDeclaration", "scope": 10085, "src": "8203:20:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 10042, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "8203:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 10045, "mutability": "mutable", "name": "KPI", "nameLocation": "8241:3:19", "nodeType": "VariableDeclaration", "scope": 10085, "src": "8233:11:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 10044, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "8233:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 10048, "mutability": "mutable", "name": "config", "nameLocation": "8267:6:19", "nodeType": "VariableDeclaration", "scope": 10085, "src": "8254:19:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}, "typeName": {"id": 10047, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 10046, "name": "OptionConfig", "nodeType": "IdentifierPath", "referencedDeclaration": 11465, "src": "8254:12:19"}, "referencedDeclaration": 11465, "src": "8254:12:19", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}}, "visibility": "internal"}, {"constant": false, "id": 10051, "mutability": "mutable", "name": "pool", "nameLocation": "8300:4:19", "nodeType": "VariableDeclaration", "scope": 10085, "src": "8283:21:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}, "typeName": {"id": 10050, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 10049, "name": "BufferIBFRPoolV2", "nodeType": "IdentifierPath", "referencedDeclaration": 12690, "src": "8283:16:19"}, "referencedDeclaration": 12690, "src": "8283:16:19", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}}, "visibility": "internal"}], "src": "8134:176:19"}, "returnParameters": {"id": 10059, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 10054, "mutability": "mutable", "name": "total", "nameLocation": "8379:5:19", "nodeType": "VariableDeclaration", "scope": 10085, "src": "8371:13:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 10053, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "8371:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 10056, "mutability": "mutable", "name": "settlementFee", "nameLocation": "8406:13:19", "nodeType": "VariableDeclaration", "scope": 10085, "src": "8398:21:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 10055, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "8398:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 10058, "mutability": "mutable", "name": "premium", "nameLocation": "8441:7:19", "nodeType": "VariableDeclaration", "scope": 10085, "src": "8433:15:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 10057, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "8433:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "8357:101:19"}, "scope": 10206, "src": "8112:625:19", "stateMutability": "view", "virtual": false, "visibility": "external"}, {"body": {"id": 10105, "nodeType": "Block", "src": "9002:73:19", "statements": [{"expression": {"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 10103, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"components": [{"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 10100, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"id": 10096, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10088, "src": "9020:6:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "*", "rightExpression": {"arguments": [], "expression": {"argumentTypes": [], "expression": {"id": 10097, "name": "config", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10091, "src": "9029:6:19", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}}, "id": 10098, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "settlementFeePercentage", "nodeType": "MemberAccess", "referencedDeclaration": 11112, "src": "9029:30:19", "typeDescriptions": {"typeIdentifier": "t_function_external_view$__$returns$_t_uint256_$", "typeString": "function () view external returns (uint256)"}}, "id": 10099, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "9029:32:19", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "9020:41:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "id": 10101, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "9019:43:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "/", "rightExpression": {"hexValue": "313030", "id": 10102, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "9065:3:19", "typeDescriptions": {"typeIdentifier": "t_rational_100_by_1", "typeString": "int_const 100"}, "value": "100"}, "src": "9019:49:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "functionReturnParameters": 10095, "id": 10104, "nodeType": "Return", "src": "9012:56:19"}]}, "documentation": {"id": 10086, "nodeType": "StructuredDocumentation", "src": "8743:127:19", "text": " @notice Calculates settlementFee\n @param amount Option amount\n @return fee Settlement fee amount"}, "id": 10106, "implemented": true, "kind": "function", "modifiers": [], "name": "getSettlementFee", "nameLocation": "8884:16:19", "nodeType": "FunctionDefinition", "parameters": {"id": 10092, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 10088, "mutability": "mutable", "name": "amount", "nameLocation": "8909:6:19", "nodeType": "VariableDeclaration", "scope": 10106, "src": "8901:14:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 10087, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "8901:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 10091, "mutability": "mutable", "name": "config", "nameLocation": "8930:6:19", "nodeType": "VariableDeclaration", "scope": 10106, "src": "8917:19:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}, "typeName": {"id": 10090, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 10089, "name": "OptionConfig", "nodeType": "IdentifierPath", "referencedDeclaration": 11465, "src": "8917:12:19"}, "referencedDeclaration": 11465, "src": "8917:12:19", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}}, "visibility": "internal"}], "src": "8900:37:19"}, "returnParameters": {"id": 10095, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 10094, "mutability": "mutable", "name": "fee", "nameLocation": "8993:3:19", "nodeType": "VariableDeclaration", "scope": 10106, "src": "8985:11:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 10093, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "8985:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "8984:13:19"}, "scope": 10206, "src": "8875:200:19", "stateMutability": "view", "virtual": false, "visibility": "internal"}, {"body": {"id": 10154, "nodeType": "Block", "src": "9351:371:19", "statements": [{"assignments": [10130], "declarations": [{"constant": false, "id": 10130, "mutability": "mutable", "name": "usdPremium", "nameLocation": "9436:10:19", "nodeType": "VariableDeclaration", "scope": 10154, "src": "9428:18:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 10129, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "9428:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "id": 10144, "initialValue": {"arguments": [{"arguments": [{"id": 10134, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10108, "src": "9522:6:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 10135, "name": "pool", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10111, "src": "9530:4:19", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}}, {"id": 10136, "name": "config", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10114, "src": "9536:6:19", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}, {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}], "id": 10133, "name": "currentImpliedVolatility", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9799, "src": "9497:24:19", "typeDescriptions": {"typeIdentifier": "t_function_internal_view$_t_uint256_$_t_contract$_BufferIBFRPoolV2_$12690_$_t_contract$_OptionConfig_$11465_$returns$_t_uint256_$", "typeString": "function (uint256,contract BufferIBFRPoolV2,contract OptionConfig) view returns (uint256)"}}, "id": 10137, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "9497:46:19", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 10138, "name": "strike", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10116, "src": "9557:6:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 10139, "name": "currentPrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10120, "src": "9577:12:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 10140, "name": "period", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10118, "src": "9603:6:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 10141, "name": "isYes", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10122, "src": "9623:5:19", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, {"id": 10142, "name": "isAbove", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10124, "src": "9642:7:19", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_bool", "typeString": "bool"}, {"typeIdentifier": "t_bool", "typeString": "bool"}], "expression": {"id": 10131, "name": "OptionMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22206, "src": "9449:10:19", "typeDescriptions": {"typeIdentifier": "t_type$_t_contract$_OptionMath_$22206_$", "typeString": "type(library OptionMath)"}}, "id": 10132, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "blackScholesPriceBinary", "nodeType": "MemberAccess", "referencedDeclaration": 22107, "src": "9449:34:19", "typeDescriptions": {"typeIdentifier": "t_function_delegatecall_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_bool_$_t_bool_$returns$_t_uint256_$", "typeString": "function (uint256,uint256,uint256,uint256,bool,bool) pure returns (uint256)"}}, "id": 10143, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "9449:210:19", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "VariableDeclarationStatement", "src": "9428:231:19"}, {"expression": {"id": 10152, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 10145, "name": "premium", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10127, "src": "9669:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 10151, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"components": [{"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 10148, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"id": 10146, "name": "usdPremium", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10130, "src": "9680:10:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "*", "rightExpression": {"id": 10147, "name": "amount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10108, "src": "9693:6:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "9680:19:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "id": 10149, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "9679:21:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "/", "rightExpression": {"id": 10150, "name": "currentPrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10120, "src": "9703:12:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "9679:36:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "9669:46:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 10153, "nodeType": "ExpressionStatement", "src": "9669:46:19"}]}, "id": 10155, "implemented": true, "kind": "function", "modifiers": [], "name": "getPremium", "nameLocation": "9090:10:19", "nodeType": "FunctionDefinition", "parameters": {"id": 10125, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 10108, "mutability": "mutable", "name": "amount", "nameLocation": "9118:6:19", "nodeType": "VariableDeclaration", "scope": 10155, "src": "9110:14:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 10107, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "9110:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 10111, "mutability": "mutable", "name": "pool", "nameLocation": "9151:4:19", "nodeType": "VariableDeclaration", "scope": 10155, "src": "9134:21:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}, "typeName": {"id": 10110, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 10109, "name": "BufferIBFRPoolV2", "nodeType": "IdentifierPath", "referencedDeclaration": 12690, "src": "9134:16:19"}, "referencedDeclaration": 12690, "src": "9134:16:19", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}}, "visibility": "internal"}, {"constant": false, "id": 10114, "mutability": "mutable", "name": "config", "nameLocation": "9178:6:19", "nodeType": "VariableDeclaration", "scope": 10155, "src": "9165:19:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}, "typeName": {"id": 10113, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 10112, "name": "OptionConfig", "nodeType": "IdentifierPath", "referencedDeclaration": 11465, "src": "9165:12:19"}, "referencedDeclaration": 11465, "src": "9165:12:19", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}}, "visibility": "internal"}, {"constant": false, "id": 10116, "mutability": "mutable", "name": "strike", "nameLocation": "9202:6:19", "nodeType": "VariableDeclaration", "scope": 10155, "src": "9194:14:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 10115, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "9194:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 10118, "mutability": "mutable", "name": "period", "nameLocation": "9226:6:19", "nodeType": "VariableDeclaration", "scope": 10155, "src": "9218:14:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 10117, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "9218:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 10120, "mutability": "mutable", "name": "currentPrice", "nameLocation": "9250:12:19", "nodeType": "VariableDeclaration", "scope": 10155, "src": "9242:20:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 10119, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "9242:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 10122, "mutability": "mutable", "name": "isYes", "nameLocation": "9277:5:19", "nodeType": "VariableDeclaration", "scope": 10155, "src": "9272:10:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}, "typeName": {"id": 10121, "name": "bool", "nodeType": "ElementaryTypeName", "src": "9272:4:19", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "visibility": "internal"}, {"constant": false, "id": 10124, "mutability": "mutable", "name": "isAbove", "nameLocation": "9297:7:19", "nodeType": "VariableDeclaration", "scope": 10155, "src": "9292:12:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}, "typeName": {"id": 10123, "name": "bool", "nodeType": "ElementaryTypeName", "src": "9292:4:19", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, "visibility": "internal"}], "src": "9100:210:19"}, "returnParameters": {"id": 10128, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 10127, "mutability": "mutable", "name": "premium", "nameLocation": "9342:7:19", "nodeType": "VariableDeclaration", "scope": 10155, "src": "9334:15:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 10126, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "9334:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "9333:17:19"}, "scope": 10206, "src": "9081:641:19", "stateMutability": "view", "virtual": false, "visibility": "internal"}, {"body": {"id": 10204, "nodeType": "Block", "src": "9970:446:19", "statements": [{"assignments": [10174], "declarations": [{"constant": false, "id": 10174, "mutability": "mutable", "name": "usdPremium", "nameLocation": "10055:10:19", "nodeType": "VariableDeclaration", "scope": 10204, "src": "10047:18:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 10173, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "10047:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "id": 10193, "initialValue": {"arguments": [{"arguments": [{"expression": {"id": 10178, "name": "optionDetails", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10158, "src": "10141:13:19", "typeDescriptions": {"typeIdentifier": "t_struct$_OptionDetails_$18516_memory_ptr", "typeString": "struct IBufferOptions.OptionDetails memory"}}, "id": 10179, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberName": "amount", "nodeType": "MemberAccess", "referencedDeclaration": 18509, "src": "10141:20:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 10180, "name": "pool", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10161, "src": "10163:4:19", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}}, {"id": 10181, "name": "config", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10164, "src": "10169:6:19", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}, {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}], "id": 10177, "name": "currentImpliedVolatility", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 9799, "src": "10116:24:19", "typeDescriptions": {"typeIdentifier": "t_function_internal_view$_t_uint256_$_t_contract$_BufferIBFRPoolV2_$12690_$_t_contract$_OptionConfig_$11465_$returns$_t_uint256_$", "typeString": "function (uint256,contract BufferIBFRPoolV2,contract OptionConfig) view returns (uint256)"}}, "id": 10182, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "10116:60:19", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"expression": {"id": 10183, "name": "optionDetails", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10158, "src": "10190:13:19", "typeDescriptions": {"typeIdentifier": "t_struct$_OptionDetails_$18516_memory_ptr", "typeString": "struct IBufferOptions.OptionDetails memory"}}, "id": 10184, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberName": "strike", "nodeType": "MemberAccess", "referencedDeclaration": 18511, "src": "10190:20:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"id": 10185, "name": "KPI", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10168, "src": "10224:3:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"expression": {"id": 10186, "name": "optionDetails", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10158, "src": "10241:13:19", "typeDescriptions": {"typeIdentifier": "t_struct$_OptionDetails_$18516_memory_ptr", "typeString": "struct IBufferOptions.OptionDetails memory"}}, "id": 10187, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberName": "period", "nodeType": "MemberAccess", "referencedDeclaration": 18507, "src": "10241:20:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, {"expression": {"id": 10188, "name": "optionDetails", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10158, "src": "10275:13:19", "typeDescriptions": {"typeIdentifier": "t_struct$_OptionDetails_$18516_memory_ptr", "typeString": "struct IBufferOptions.OptionDetails memory"}}, "id": 10189, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberName": "isYes", "nodeType": "MemberAccess", "referencedDeclaration": 18513, "src": "10275:19:19", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}, {"expression": {"id": 10190, "name": "optionDetails", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10158, "src": "10308:13:19", "typeDescriptions": {"typeIdentifier": "t_struct$_OptionDetails_$18516_memory_ptr", "typeString": "struct IBufferOptions.OptionDetails memory"}}, "id": 10191, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberName": "isAbove", "nodeType": "MemberAccess", "referencedDeclaration": 18515, "src": "10308:21:19", "typeDescriptions": {"typeIdentifier": "t_bool", "typeString": "bool"}}], "expression": {"argumentTypes": [{"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_uint256", "typeString": "uint256"}, {"typeIdentifier": "t_bool", "typeString": "bool"}, {"typeIdentifier": "t_bool", "typeString": "bool"}], "expression": {"id": 10175, "name": "OptionMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22206, "src": "10068:10:19", "typeDescriptions": {"typeIdentifier": "t_type$_t_contract$_OptionMath_$22206_$", "typeString": "type(library OptionMath)"}}, "id": 10176, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberName": "blackScholesPriceBinary", "nodeType": "MemberAccess", "referencedDeclaration": 22107, "src": "10068:34:19", "typeDescriptions": {"typeIdentifier": "t_function_delegatecall_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_bool_$_t_bool_$returns$_t_uint256_$", "typeString": "function (uint256,uint256,uint256,uint256,bool,bool) pure returns (uint256)"}}, "id": 10192, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "names": [], "nodeType": "FunctionCall", "src": "10068:271:19", "tryCall": false, "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "VariableDeclarationStatement", "src": "10047:292:19"}, {"expression": {"id": 10202, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": {"id": 10194, "name": "premium", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10171, "src": "10349:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "Assignment", "operator": "=", "rightHandSide": {"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 10201, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"components": [{"commonType": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "id": 10198, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": {"id": 10195, "name": "usdPremium", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10174, "src": "10360:10:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "*", "rightExpression": {"expression": {"id": 10196, "name": "optionDetails", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10158, "src": "10373:13:19", "typeDescriptions": {"typeIdentifier": "t_struct$_OptionDetails_$18516_memory_ptr", "typeString": "struct IBufferOptions.OptionDetails memory"}}, "id": 10197, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberName": "amount", "nodeType": "MemberAccess", "referencedDeclaration": 18509, "src": "10373:20:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "10360:33:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}], "id": 10199, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "10359:35:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "nodeType": "BinaryOperation", "operator": "/", "rightExpression": {"id": 10200, "name": "currentPrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 10166, "src": "10397:12:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "10359:50:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "src": "10349:60:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "id": 10203, "nodeType": "ExpressionStatement", "src": "10349:60:19"}]}, "id": 10205, "implemented": true, "kind": "function", "modifiers": [], "name": "getPremiumBinary", "nameLocation": "9737:16:19", "nodeType": "FunctionDefinition", "parameters": {"id": 10169, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 10158, "mutability": "mutable", "name": "optionDetails", "nameLocation": "9799:13:19", "nodeType": "VariableDeclaration", "scope": 10205, "src": "9763:49:19", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": {"typeIdentifier": "t_struct$_OptionDetails_$18516_memory_ptr", "typeString": "struct IBufferOptions.OptionDetails"}, "typeName": {"id": 10157, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 10156, "name": "IBufferOptions.OptionDetails", "nodeType": "IdentifierPath", "referencedDeclaration": 18516, "src": "9763:28:19"}, "referencedDeclaration": 18516, "src": "9763:28:19", "typeDescriptions": {"typeIdentifier": "t_struct$_OptionDetails_$18516_storage_ptr", "typeString": "struct IBufferOptions.OptionDetails"}}, "visibility": "internal"}, {"constant": false, "id": 10161, "mutability": "mutable", "name": "pool", "nameLocation": "9839:4:19", "nodeType": "VariableDeclaration", "scope": 10205, "src": "9822:21:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}, "typeName": {"id": 10160, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 10159, "name": "BufferIBFRPoolV2", "nodeType": "IdentifierPath", "referencedDeclaration": 12690, "src": "9822:16:19"}, "referencedDeclaration": 12690, "src": "9822:16:19", "typeDescriptions": {"typeIdentifier": "t_contract$_BufferIBFRPoolV2_$12690", "typeString": "contract BufferIBFRPoolV2"}}, "visibility": "internal"}, {"constant": false, "id": 10164, "mutability": "mutable", "name": "config", "nameLocation": "9866:6:19", "nodeType": "VariableDeclaration", "scope": 10205, "src": "9853:19:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}, "typeName": {"id": 10163, "nodeType": "UserDefinedTypeName", "pathNode": {"id": 10162, "name": "OptionConfig", "nodeType": "IdentifierPath", "referencedDeclaration": 11465, "src": "9853:12:19"}, "referencedDeclaration": 11465, "src": "9853:12:19", "typeDescriptions": {"typeIdentifier": "t_contract$_OptionConfig_$11465", "typeString": "contract OptionConfig"}}, "visibility": "internal"}, {"constant": false, "id": 10166, "mutability": "mutable", "name": "currentPrice", "nameLocation": "9890:12:19", "nodeType": "VariableDeclaration", "scope": 10205, "src": "9882:20:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 10165, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "9882:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}, {"constant": false, "id": 10168, "mutability": "mutable", "name": "KPI", "nameLocation": "9920:3:19", "nodeType": "VariableDeclaration", "scope": 10205, "src": "9912:11:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 10167, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "9912:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "9753:176:19"}, "returnParameters": {"id": 10172, "nodeType": "ParameterList", "parameters": [{"constant": false, "id": 10171, "mutability": "mutable", "name": "premium", "nameLocation": "9961:7:19", "nodeType": "VariableDeclaration", "scope": 10205, "src": "9953:15:19", "stateVariable": false, "storageLocation": "default", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}, "typeName": {"id": 10170, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "9953:7:19", "typeDescriptions": {"typeIdentifier": "t_uint256", "typeString": "uint256"}}, "visibility": "internal"}], "src": "9952:17:19"}, "scope": 10206, "src": "9728:688:19", "stateMutability": "view", "virtual": false, "visibility": "internal"}], "scope": 10207, "src": "668:9750:19", "usedErrors": []}], "src": "38:10381:19"}, "compiler": {"version": "0.8.4+commit.c7e474f2", "evm_version": "istanbul", "optimizer": {"enabled": true, "runs": 1}}, "contractName": "FeeCalculator", "deployedBytecode": "73000000000000000000000000000000000000000030146080604052600436106100775760003560e01c80630cd5f90f1461007c5780630e04d1bc146100a257806327150148146100d0578063c4653f31146100e3578063ce460184146100f6578063d13a79bc14610109578063e39d06e91461011c575b600080fd5b61008f61008a366004610a0f565b61012f565b6040519081526020015b60405180910390f35b6100b56100b036600461092c565b61027c565b60408051938452602084019290925290820152606001610099565b6100b56100de366004610aff565b6102b7565b6100b56100f1366004610aff565b6103b7565b61008f610104366004610a3e565b6104a7565b6100b5610117366004610a7f565b6105de565b61008f61012a366004610a7f565b61061b565b600080826001600160a01b031663d9ac10d96040518163ffffffff1660e01b815260040160206040518083038186803b15801561016b57600080fd5b505afa15801561017f573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906101a391906109f7565b9050600081116101de5760405162461bcd60e51b815260206004820152600260248201526109e760f31b604482015260640160405180910390fd5b8084846001600160a01b0316636ab28bc86040518163ffffffff1660e01b815260040160206040518083038186803b15801561021957600080fd5b505afa15801561022d573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061025191906109f7565b61025b9190610bc4565b61026a906402540be400610bfc565b6102749190610bdc565b949350505050565b600080600061028e8885878a8a6106df565b905061029e8860200151866107b9565b91506102aa8183610bc4565b9250955095509592505050565b60008060008073__$21a7d244ba8ae9c6f13b9eaa6b054f8aee$__632c607c3b6102e28c888a6104a7565b8b8a8f60028e600281111561030757634e487b7160e01b600052602160045260246000fd5b146040518663ffffffff1660e01b8152600401610328959493929190610b73565b60206040518083038186803b15801561034057600080fd5b505af4158015610354573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061037891906109f7565b9050866103858b83610bfc565b61038f9190610bdc565b915061039b8a876107b9565b92506103a78284610bc4565b9350509750975097945050505050565b60008060008073__$21a7d244ba8ae9c6f13b9eaa6b054f8aee$__632c607c3b6103e28c888a6104a7565b8b8a8f60028e600281111561040757634e487b7160e01b600052602160045260246000fd5b146040518663ffffffff1660e01b8152600401610428959493929190610b73565b60206040518083038186803b15801561044057600080fd5b505af4158015610454573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061047891906109f7565b90506104848a876107b9565b9250866104918b83610bfc565b61049b9190610bdc565b91506103a78284610bc4565b6000816001600160a01b03166318f88e5b6040518163ffffffff1660e01b815260040160206040518083038186803b1580156104e257600080fd5b505afa1580156104f6573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061051a91906109f7565b90506000610528858561012f565b905063ee6b28008111156105d657826001600160a01b0316636c321c8a6040518163ffffffff1660e01b815260040160206040518083038186803b15801561056f57600080fd5b505afa158015610583573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906105a791906109f7565b6105b563ee6b280083610c1b565b6105bf9084610bfc565b6105c99190610bdc565b6105d39083610bc4565b91505b509392505050565b60008060006105f38a85878c8f8b8e8e610849565b90506105ff8a866107b9565b915061060b8183610bc4565b9250985098509895505050505050565b60006305f5e1008873__$21a7d244ba8ae9c6f13b9eaa6b054f8aee$__63d573d6156106488c87896104a7565b8b898f8d8d6040518763ffffffff1660e01b815260040161066e96959493929190610b98565b60206040518083038186803b15801561068657600080fd5b505af415801561069a573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906106be91906109f7565b6106c89190610bfc565b6106d29190610bdc565b9998505050505050505050565b60008073__$21a7d244ba8ae9c6f13b9eaa6b054f8aee$__63d573d61561070b896020015189896104a7565b6040808b01518b5160608d015160808e015193516001600160e01b031960e088901b16815261074195948b939291600401610b98565b60206040518083038186803b15801561075957600080fd5b505af415801561076d573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061079191906109f7565b9050838760200151826107a49190610bfc565b6107ae9190610bdc565b979650505050505050565b60006064826001600160a01b031663f3fa34956040518163ffffffff1660e01b815260040160206040518083038186803b1580156107f657600080fd5b505afa15801561080a573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061082e91906109f7565b6108389085610bfc565b6108429190610bdc565b9392505050565b60008073__$21a7d244ba8ae9c6f13b9eaa6b054f8aee$__63d573d6156108718c8c8c6104a7565b89888a89896040518763ffffffff1660e01b815260040161089796959493929190610b98565b60206040518083038186803b1580156108af57600080fd5b505af41580156108c3573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906108e791906109f7565b9050846108f48b83610bfc565b6108fe9190610bdc565b9a9950505050505050505050565b8035801515811461091c57600080fd5b919050565b803561091c81610c48565b6000806000806000858703610120811215610945578182fd5b60a0811215610952578182fd5b5060405160a081016001600160401b038111828210171561098157634e487b7160e01b83526041600452602483fd5b80604052508635815260208701356020820152604087013560408201526109aa6060880161090c565b60608201526109bb6080880161090c565b6080820152945060a0860135935060c086013592506109dc60e08701610921565b91506109eb6101008701610921565b90509295509295909350565b600060208284031215610a08578081fd5b5051919050565b60008060408385031215610a21578182fd5b823591506020830135610a3381610c48565b809150509250929050565b600080600060608486031215610a52578283fd5b833592506020840135610a6481610c48565b91506040840135610a7481610c48565b809150509250925092565b600080600080600080600080610100898b031215610a9b578283fd5b883597506020890135965060408901359550610ab960608a0161090c565b9450610ac760808a0161090c565b935060a0890135925060c0890135610ade81610c48565b915060e0890135610aee81610c48565b809150509295985092959890939650565b600080600080600080600060e0888a031215610b19578283fd5b873596506020880135955060408801359450606088013560038110610b3c578384fd5b93506080880135925060a0880135610b5381610c48565b915060c0880135610b6381610c48565b8091505092959891949750929550565b9485526020850193909352604084019190915260608301521515608082015260a00190565b95865260208601949094526040850192909252606084015215156080830152151560a082015260c00190565b60008219821115610bd757610bd7610c32565b500190565b600082610bf757634e487b7160e01b81526012600452602481fd5b500490565b6000816000190483118215151615610c1657610c16610c32565b500290565b600082821015610c2d57610c2d610c32565b500390565b634e487b7160e01b600052601160045260246000fd5b6001600160a01b0381168114610c5d57600080fd5b5056fea26469706673582212204718cc67318816a547e043d04e886f3154ceacf08e3ac1e83de0647cead34ada64736f6c63430008040033", "deployedSourceMap": "668:9750:19:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;890:319;;;;;;:::i;:::-;;:::i;:::-;;;5093:25:35;;;5081:2;5066:18;890:319:19;;;;;;;;8112:625;;;;;;:::i;:::-;;:::i;:::-;;;;5339:25:35;;;5395:2;5380:18;;5373:34;;;;5423:18;;;5416:34;5327:2;5312:18;8112:625:19;5294:162:35;2571:860:19;;;;;;:::i;:::-;;:::i;4104:869::-;;;;;;:::i;:::-;;:::i;1533:383::-;;;;;;:::i;:::-;;:::i;6900:692::-;;;;;;:::i;:::-;;:::i;5584:578::-;;;;;;:::i;:::-;;:::i;890:319::-;1001:19;1036;1058:4;-1:-1:-1;;;;;1058:23:19;;:25;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;1036:47;;1115:1;1101:11;:15;1093:30;;;;-1:-1:-1;;;1093:30:19;;4811:2:35;1093:30:19;;;4793:21:35;4850:1;4830:18;;;4823:29;-1:-1:-1;;;4868:18:35;;;4861:32;4910:18;;1093:30:19;;;;;;;;1191:11;1172:6;1150:4;-1:-1:-1;;;;;1150:17:19;;:19;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;:28;;;;:::i;:::-;1149:38;;1182:5;1149:38;:::i;:::-;1148:54;;;;:::i;:::-;1134:68;890:319;-1:-1:-1;;;;890:319:19:o;8112:625::-;8371:13;8398:21;8433:15;8483:134;8513:13;8540:4;8558:6;8578:12;8604:3;8483:16;:134::i;:::-;8473:144;;8643:46;8660:13;:20;;;8682:6;8643:16;:46::i;:::-;8627:62;-1:-1:-1;8707:23:19;8723:7;8627:62;8707:23;:::i;:::-;8699:31;;8112:625;;;;;;;;;:::o;2571:860::-;2857:13;2884:21;2919:15;3026:18;3047:10;:28;3089:46;3114:6;3122:4;3128:6;3089:24;:46::i;:::-;3149:6;3169:12;3195:6;3229:30;3215:10;:44;;;;;;-1:-1:-1;;;3215:44:19;;;;;;;;;;3047:222;;;;;;;;;;;;;;;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;3026:243;-1:-1:-1;3313:12:19;3290:19;3303:6;3026:243;3290:19;:::i;:::-;3289:36;;;;:::i;:::-;3279:46;;3351:32;3368:6;3376;3351:16;:32::i;:::-;3335:48;-1:-1:-1;3401:23:19;3417:7;3335:48;3401:23;:::i;:::-;3393:31;;2571:860;;;;;;;;;;;;:::o;4104:869::-;4393:13;4420:21;4455:15;4568:18;4589:10;:28;4631:46;4656:6;4664:4;4670:6;4631:24;:46::i;:::-;4691:6;4711:12;4737:6;4771:30;4757:10;:44;;;;;;-1:-1:-1;;;4757:44:19;;;;;;;;;;4589:222;;;;;;;;;;;;;;;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;4568:243;;4837:32;4854:6;4862;4837:16;:32::i;:::-;4821:48;-1:-1:-1;4913:12:19;4890:19;4903:6;4890:10;:19;:::i;:::-;4889:36;;;;:::i;:::-;4879:46;-1:-1:-1;4943:23:19;4879:46;4943:13;:23;:::i;1533:383::-;1678:10;1705:6;-1:-1:-1;;;;;1705:21:19;;:23;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;1700:28;;1738:19;1760:31;1778:6;1786:4;1760:17;:31::i;:::-;1738:53;;1819:4;1805:11;:18;1801:109;;;1875:6;-1:-1:-1;;;;;1875:22:19;;:24;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;1852:18;1866:4;1852:11;:18;:::i;:::-;1846:25;;:2;:25;:::i;:::-;1845:54;;;;:::i;:::-;1839:60;;;;:::i;:::-;;;1801:109;1533:383;;;;;;:::o;6900:692::-;7190:13;7217:21;7252:15;7302:184;7326:6;7346:4;7364:6;7384;7404;7424:12;7450:5;7469:7;7302:10;:184::i;:::-;7292:194;;7512:32;7529:6;7537;7512:16;:32::i;:::-;7496:48;-1:-1:-1;7562:23:19;7578:7;7496:48;7562:23;:::i;:::-;7554:31;;6900:692;;;;;;;;;;;;:::o;5584:578::-;5880:15;6152:3;6143:6;5930:10;:34;5978:46;6003:6;6011:4;6017:6;5978:24;:46::i;:::-;6038:6;6058:12;6084:6;6104:5;6123:7;5930:210;;;;;;;;;;;;;;;;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;:219;;;;:::i;:::-;:225;;;;:::i;:::-;5920:235;5584:578;-1:-1:-1;;;;;;;;;5584:578:19:o;9728:688::-;9953:15;10047:18;10068:10;:34;10116:60;10141:13;:20;;;10163:4;10169:6;10116:24;:60::i;:::-;10190:20;;;;;10241;;10275:19;;;;10308:21;;;;10068:271;;-1:-1:-1;;;;;;10068:271:19;;;;;;;;;;10224:3;;10241:20;10275:19;10068:271;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;10047:292;;10397:12;10373:13;:20;;;10360:10;:33;;;;:::i;:::-;10359:50;;;;:::i;:::-;10349:60;9728:688;-1:-1:-1;;;;;;;9728:688:19:o;8875:200::-;8985:11;9065:3;9029:6;-1:-1:-1;;;;;9029:30:19;;:32;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;9020:41;;:6;:41;:::i;:::-;9019:49;;;;:::i;:::-;9012:56;8875:200;-1:-1:-1;;;8875:200:19:o;9081:641::-;9334:15;9428:18;9449:10;:34;9497:46;9522:6;9530:4;9536:6;9497:24;:46::i;:::-;9557:6;9577:12;9603:6;9623:5;9642:7;9449:210;;;;;;;;;;;;;;;;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;9428:231;-1:-1:-1;9703:12:19;9680:19;9693:6;9428:231;9680:19;:::i;:::-;9679:36;;;;:::i;:::-;9669:46;9081:641;-1:-1:-1;;;;;;;;;;9081:641:19:o;14:160:35:-;79:20;;135:13;;128:21;118:32;;108:2;;164:1;161;154:12;108:2;60:114;;;:::o;179:170::-;265:20;;294:49;265:20;294:49;:::i;354:1283::-;529:6;537;545;553;561;605:9;596:7;592:23;635:3;631:2;627:12;624:2;;;657:6;649;642:22;624:2;686:4;682:2;678:13;675:2;;;709:6;701;694:22;675:2;-1:-1:-1;747:2:35;741:9;789:4;777:17;;-1:-1:-1;;;;;809:34:35;;845:22;;;806:62;803:2;;;-1:-1:-1;;;891:36:35;;950:4;947:1;940:15;983:4;898:6;968:20;803:2;1018:10;1014:2;1007:22;;1066:9;1053:23;1045:6;1038:39;1138:2;1127:9;1123:18;1110:32;1105:2;1097:6;1093:15;1086:57;1204:2;1193:9;1189:18;1176:32;1171:2;1163:6;1159:15;1152:57;1242:35;1273:2;1262:9;1258:18;1242:35;:::i;:::-;1237:2;1229:6;1225:15;1218:60;1312:36;1343:3;1332:9;1328:19;1312:36;:::i;:::-;1306:3;1294:16;;1287:62;1298:6;-1:-1:-1;1421:4:35;1406:20;;1393:34;;-1:-1:-1;1474:3:35;1459:19;;1446:33;;-1:-1:-1;1498:57:35;1550:3;1535:19;;1498:57;:::i;:::-;1488:67;;1574:57;1626:3;1615:9;1611:19;1574:57;:::i;:::-;1564:67;;572:1065;;;;;;;;:::o;1642:194::-;1712:6;1765:2;1753:9;1744:7;1740:23;1736:32;1733:2;;;1786:6;1778;1771:22;1733:2;-1:-1:-1;1814:16:35;;1723:113;-1:-1:-1;1723:113:35:o;1841:369::-;1935:6;1943;1996:2;1984:9;1975:7;1971:23;1967:32;1964:2;;;2017:6;2009;2002:22;1964:2;2058:9;2045:23;2035:33;;2118:2;2107:9;2103:18;2090:32;2131:49;2174:5;2131:49;:::i;:::-;2199:5;2189:15;;;1954:256;;;;;:::o;2215:550::-;2340:6;2348;2356;2409:2;2397:9;2388:7;2384:23;2380:32;2377:2;;;2430:6;2422;2415:22;2377:2;2471:9;2458:23;2448:33;;2531:2;2520:9;2516:18;2503:32;2544:49;2587:5;2544:49;:::i;:::-;2612:5;-1:-1:-1;2669:2:35;2654:18;;2641:32;2682:51;2641:32;2682:51;:::i;:::-;2752:7;2742:17;;;2367:398;;;;;:::o;2770:895::-;2934:6;2942;2950;2958;2966;2974;2982;2990;3043:3;3031:9;3022:7;3018:23;3014:33;3011:2;;;3065:6;3057;3050:22;3011:2;3106:9;3093:23;3083:33;;3163:2;3152:9;3148:18;3135:32;3125:42;;3214:2;3203:9;3199:18;3186:32;3176:42;;3237:35;3268:2;3257:9;3253:18;3237:35;:::i;:::-;3227:45;;3291:36;3322:3;3311:9;3307:19;3291:36;:::i;:::-;3281:46;;3374:3;3363:9;3359:19;3346:33;3336:43;;3429:3;3418:9;3414:19;3401:33;3443:49;3486:5;3443:49;:::i;:::-;3511:5;-1:-1:-1;3568:3:35;3553:19;;3540:33;3582:51;3540:33;3582:51;:::i;:::-;3652:7;3642:17;;;3001:664;;;;;;;;;;;:::o;3670:934::-;3847:6;3855;3863;3871;3879;3887;3895;3948:3;3936:9;3927:7;3923:23;3919:33;3916:2;;;3970:6;3962;3955:22;3916:2;4011:9;3998:23;3988:33;;4068:2;4057:9;4053:18;4040:32;4030:42;;4119:2;4108:9;4104:18;4091:32;4081:42;;4173:2;4162:9;4158:18;4145:32;4206:1;4199:5;4196:12;4186:2;;4227:6;4219;4212:22;4186:2;4255:5;-1:-1:-1;4307:3:35;4292:19;;4279:33;;-1:-1:-1;4364:3:35;4349:19;;4336:33;4378:51;4336:33;4378:51;:::i;:::-;4448:7;-1:-1:-1;4507:3:35;4492:19;;4479:33;4521:51;4479:33;4521:51;:::i;:::-;4591:7;4581:17;;;3906:698;;;;;;;;;;:::o;5461:481::-;5722:25;;;5778:2;5763:18;;5756:34;;;;5821:2;5806:18;;5799:34;;;;5864:2;5849:18;;5842:34;5920:14;5913:22;5907:3;5892:19;;5885:51;5709:3;5694:19;;5676:266::o;5947:563::-;6230:25;;;6286:2;6271:18;;6264:34;;;;6329:2;6314:18;;6307:34;;;;6372:2;6357:18;;6350:34;6428:14;6421:22;6415:3;6400:19;;6393:51;6488:14;6481:22;6475:3;6460:19;;6453:51;6217:3;6202:19;;6184:326::o;6515:128::-;6555:3;6586:1;6582:6;6579:1;6576:13;6573:2;;;6592:18;;:::i;:::-;-1:-1:-1;6628:9:35;;6563:80::o;6648:217::-;6688:1;6714;6704:2;;-1:-1:-1;;;6739:31:35;;6793:4;6790:1;6783:15;6821:4;6746:1;6811:15;6704:2;-1:-1:-1;6850:9:35;;6694:171::o;6870:168::-;6910:7;6976:1;6972;6968:6;6964:14;6961:1;6958:21;6953:1;6946:9;6939:17;6935:45;6932:2;;;6983:18;;:::i;:::-;-1:-1:-1;7023:9:35;;6922:116::o;7043:125::-;7083:4;7111:1;7108;7105:8;7102:2;;;7116:18;;:::i;:::-;-1:-1:-1;7153:9:35;;7092:76::o;7173:127::-;7234:10;7229:3;7225:20;7222:1;7215:31;7265:4;7262:1;7255:15;7289:4;7286:1;7279:15;7305:149;-1:-1:-1;;;;;7398:31:35;;7388:42;;7378:2;;7444:1;7441;7434:12;7378:2;7368:86;:::o", "language": "Solidity", "natspec": {"methods": {"currentImpliedVolatility(uint256,BufferIBFRPoolV2,OptionConfig)": {"notice": "Calculate the Utilisation adjusted ImpliedVol for the pool according to https://www.desmos.com/calculator/xdmhn97opd", "params": {"amount": "Option amount", "config": "The option configuration", "pool": "The pool selling the option"}, "returns": {"iv": "The adjusted ImpliedVol"}}, "fees(uint256,uint256,uint256,IBufferOptions.OptionType,uint256,OptionConfig,BufferIBFRPoolV2)": {"notice": "Used for getting the price for Options in tokenX", "params": {"amount": "Option amount", "config": "The option configuration", "currentPrice": "Current price of the underlying asset", "optionType": "Type of the Option", "period": "Option period in seconds (1 days <= period <= 4 weeks)", "pool": "The pool selling the option", "strike": "Strike price of the option"}, "returns": {"premium": "Amount that covers the price difference in the ITM options", "settlementFee": "Amount to be distributed to the Buffer token holders", "total": "Total price to be paid"}}, "feesBinary(uint256,uint256,uint256,bool,bool,uint256,OptionConfig,BufferIBFRPoolV2)": {"notice": "Used for getting the price for Binary Options", "params": {"amount": "Option amount", "config": "The option configuration", "currentPrice": "Current price of the underlying asset", "isAbove": "whether the price will stay above this strike or not", "isYes": "whether the option isAbove or not", "period": "Option period in seconds (1 days <= period <= 4 weeks)", "pool": "The pool selling the option", "strike": "Strike price of the option"}, "returns": {"premium": "Amount that covers the price difference in the ITM options", "settlementFee": "Amount to be distributed to the Buffer token holders", "total": "Total price to be paid"}}, "feesKPIBinary(IBufferOptions.OptionDetails,uint256,uint256,OptionConfig,BufferIBFRPoolV2)": {"notice": "Used for getting the price for Binary KPI Options", "params": {"KPI": "KPI value for option", "config": "Option config", "currentPrice": "Current price of the tokenX", "optionDetails": "Details of the option to be priced", "pool": "pool contract"}, "returns": {"premium": "Amount that covers the price difference in the ITM options", "settlementFee": "Amount to be distributed to the Buffer token holders", "total": "Total price to be paid"}}, "feesTokenXBinary(uint256,uint256,uint256,bool,bool,uint256,OptionConfig,BufferIBFRPoolV2)": {"notice": "Used for getting the price for Binary Options", "params": {"amount": "Option amount", "config": "The option configuration", "currentPrice": "Current price of the underlying asset", "isAbove": "whether the price will stay above this strike or not", "isYes": "whether the option isAbove or not", "period": "Option period in seconds (1 days <= period <= 4 weeks)", "pool": "The pool selling the option", "strike": "Strike price of the option"}, "returns": {"premium": "Amount that covers the price difference in the ITM options"}}, "feesUsd(uint256,uint256,uint256,IBufferOptions.OptionType,uint256,OptionConfig,BufferIBFRPoolV2)": {"notice": "Used for getting the price for Options in USD", "params": {"amount": "Option amount", "config": "The option configuration", "currentPrice": "Current price of the underlying asset", "optionType": "Type of the Option", "period": "Option period in seconds (1 days <= period <= 4 weeks)", "pool": "The pool selling the option", "strike": "Strike price of the option"}, "returns": {"premium": "Amount that covers the price difference in the ITM options in USD", "settlementFee": "Amount to be distributed to the Buffer token holders in USD", "total": "Total price to be paid in USD"}}, "getNewUtilisation(uint256,BufferIBFRPoolV2)": {"notice": "Calculate the current Utilisation", "params": {"amount": "Option amount", "pool": "The pool selling the option"}, "returns": {"utilization": "Current utilization"}}}, "kind": "dev", "version": 1}, "opcodes": "PUSH20 0x0 ADDRESS EQ PUSH1 0x80 PUSH1 0x40 MSTORE PUSH1 0x4 CALLDATASIZE LT PUSH2 0x77 JUMPI PUSH1 0x0 CALLDATALOAD PUSH1 0xE0 SHR DUP1 PUSH4 0xCD5F90F EQ PUSH2 0x7C JUMPI DUP1 PUSH4 0xE04D1BC EQ PUSH2 0xA2 JUMPI DUP1 PUSH4 0x27150148 EQ PUSH2 0xD0 JUMPI DUP1 PUSH4 0xC4653F31 EQ PUSH2 0xE3 JUMPI DUP1 PUSH4 0xCE460184 EQ PUSH2 0xF6 JUMPI DUP1 PUSH4 0xD13A79BC EQ PUSH2 0x109 JUMPI DUP1 PUSH4 0xE39D06E9 EQ PUSH2 0x11C JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH2 0x8F PUSH2 0x8A CALLDATASIZE PUSH1 0x4 PUSH2 0xA0F JUMP JUMPDEST PUSH2 0x12F JUMP JUMPDEST PUSH1 0x40 MLOAD SWAP1 DUP2 MSTORE PUSH1 0x20 ADD JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH2 0xB5 PUSH2 0xB0 CALLDATASIZE PUSH1 0x4 PUSH2 0x92C JUMP JUMPDEST PUSH2 0x27C JUMP JUMPDEST PUSH1 0x40 DUP1 MLOAD SWAP4 DUP5 MSTORE PUSH1 0x20 DUP5 ADD SWAP3 SWAP1 SWAP3 MSTORE SWAP1 DUP3 ADD MSTORE PUSH1 0x60 ADD PUSH2 0x99 JUMP JUMPDEST PUSH2 0xB5 PUSH2 0xDE CALLDATASIZE PUSH1 0x4 PUSH2 0xAFF JUMP JUMPDEST PUSH2 0x2B7 JUMP JUMPDEST PUSH2 0xB5 PUSH2 0xF1 CALLDATASIZE PUSH1 0x4 PUSH2 0xAFF JUMP JUMPDEST PUSH2 0x3B7 JUMP JUMPDEST PUSH2 0x8F PUSH2 0x104 CALLDATASIZE PUSH1 0x4 PUSH2 0xA3E JUMP JUMPDEST PUSH2 0x4A7 JUMP JUMPDEST PUSH2 0xB5 PUSH2 0x117 CALLDATASIZE PUSH1 0x4 PUSH2 0xA7F JUMP JUMPDEST PUSH2 0x5DE JUMP JUMPDEST PUSH2 0x8F PUSH2 0x12A CALLDATASIZE PUSH1 0x4 PUSH2 0xA7F JUMP JUMPDEST PUSH2 0x61B JUMP JUMPDEST PUSH1 0x0 DUP1 DUP3 PUSH1 0x1 PUSH1 0x1 PUSH1 0xA0 SHL SUB AND PUSH4 0xD9AC10D9 PUSH1 0x40 MLOAD DUP2 PUSH4 0xFFFFFFFF AND PUSH1 0xE0 SHL DUP2 MSTORE PUSH1 0x4 ADD PUSH1 0x20 PUSH1 0x40 MLOAD DUP1 DUP4 SUB DUP2 DUP7 DUP1 EXTCODESIZE ISZERO DUP1 ISZERO PUSH2 0x16B JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP GAS STATICCALL ISZERO DUP1 ISZERO PUSH2 0x17F JUMPI RETURNDATASIZE PUSH1 0x0 DUP1 RETURNDATACOPY RETURNDATASIZE PUSH1 0x0 REVERT JUMPDEST POP POP POP POP PUSH1 0x40 MLOAD RETURNDATASIZE PUSH1 0x1F NOT PUSH1 0x1F DUP3 ADD AND DUP3 ADD DUP1 PUSH1 0x40 MSTORE POP DUP2 ADD SWAP1 PUSH2 0x1A3 SWAP2 SWAP1 PUSH2 0x9F7 JUMP JUMPDEST SWAP1 POP PUSH1 0x0 DUP2 GT PUSH2 0x1DE JUMPI PUSH1 0x40 MLOAD PUSH3 0x461BCD PUSH1 0xE5 SHL DUP2 MSTORE PUSH1 0x20 PUSH1 0x4 DUP3 ADD MSTORE PUSH1 0x2 PUSH1 0x24 DUP3 ADD MSTORE PUSH2 0x9E7 PUSH1 0xF3 SHL PUSH1 0x44 DUP3 ADD MSTORE PUSH1 0x64 ADD PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 REVERT JUMPDEST DUP1 DUP5 DUP5 PUSH1 0x1 PUSH1 0x1 PUSH1 0xA0 SHL SUB AND PUSH4 0x6AB28BC8 PUSH1 0x40 MLOAD DUP2 PUSH4 0xFFFFFFFF AND PUSH1 0xE0 SHL DUP2 MSTORE PUSH1 0x4 ADD PUSH1 0x20 PUSH1 0x40 MLOAD DUP1 DUP4 SUB DUP2 DUP7 DUP1 EXTCODESIZE ISZERO DUP1 ISZERO PUSH2 0x219 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP GAS STATICCALL ISZERO DUP1 ISZERO PUSH2 0x22D JUMPI RETURNDATASIZE PUSH1 0x0 DUP1 RETURNDATACOPY RETURNDATASIZE PUSH1 0x0 REVERT JUMPDEST POP POP POP POP PUSH1 0x40 MLOAD RETURNDATASIZE PUSH1 0x1F NOT PUSH1 0x1F DUP3 ADD AND DUP3 ADD DUP1 PUSH1 0x40 MSTORE POP DUP2 ADD SWAP1 PUSH2 0x251 SWAP2 SWAP1 PUSH2 0x9F7 JUMP JUMPDEST PUSH2 0x25B SWAP2 SWAP1 PUSH2 0xBC4 JUMP JUMPDEST PUSH2 0x26A SWAP1 PUSH5 0x2540BE400 PUSH2 0xBFC JUMP JUMPDEST PUSH2 0x274 SWAP2 SWAP1 PUSH2 0xBDC JUMP JUMPDEST SWAP5 SWAP4 POP POP POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x0 PUSH2 0x28E DUP9 DUP6 DUP8 DUP11 DUP11 PUSH2 0x6DF JUMP JUMPDEST SWAP1 POP PUSH2 0x29E DUP9 PUSH1 0x20 ADD MLOAD DUP7 PUSH2 0x7B9 JUMP JUMPDEST SWAP2 POP PUSH2 0x2AA DUP2 DUP4 PUSH2 0xBC4 JUMP JUMPDEST SWAP3 POP SWAP6 POP SWAP6 POP SWAP6 SWAP3 POP POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x0 DUP1 PUSH20 0x0 PUSH4 0x2C607C3B PUSH2 0x2E2 DUP13 DUP9 DUP11 PUSH2 0x4A7 JUMP JUMPDEST DUP12 DUP11 DUP16 PUSH1 0x2 DUP15 PUSH1 0x2 DUP2 GT ISZERO PUSH2 0x307 JUMPI PUSH4 0x4E487B71 PUSH1 0xE0 SHL PUSH1 0x0 MSTORE PUSH1 0x21 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH1 0x0 REVERT JUMPDEST EQ PUSH1 0x40 MLOAD DUP7 PUSH4 0xFFFFFFFF AND PUSH1 0xE0 SHL DUP2 MSTORE PUSH1 0x4 ADD PUSH2 0x328 SWAP6 SWAP5 SWAP4 SWAP3 SWAP2 SWAP1 PUSH2 0xB73 JUMP JUMPDEST PUSH1 0x20 PUSH1 0x40 MLOAD DUP1 DUP4 SUB DUP2 DUP7 DUP1 EXTCODESIZE ISZERO DUP1 ISZERO PUSH2 0x340 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP GAS DELEGATECALL ISZERO DUP1 ISZERO PUSH2 0x354 JUMPI RETURNDATASIZE PUSH1 0x0 DUP1 RETURNDATACOPY RETURNDATASIZE PUSH1 0x0 REVERT JUMPDEST POP POP POP POP PUSH1 0x40 MLOAD RETURNDATASIZE PUSH1 0x1F NOT PUSH1 0x1F DUP3 ADD AND DUP3 ADD DUP1 PUSH1 0x40 MSTORE POP DUP2 ADD SWAP1 PUSH2 0x378 SWAP2 SWAP1 PUSH2 0x9F7 JUMP JUMPDEST SWAP1 POP DUP7 PUSH2 0x385 DUP12 DUP4 PUSH2 0xBFC JUMP JUMPDEST PUSH2 0x38F SWAP2 SWAP1 PUSH2 0xBDC JUMP JUMPDEST SWAP2 POP PUSH2 0x39B DUP11 DUP8 PUSH2 0x7B9 JUMP JUMPDEST SWAP3 POP PUSH2 0x3A7 DUP3 DUP5 PUSH2 0xBC4 JUMP JUMPDEST SWAP4 POP POP SWAP8 POP SWAP8 POP SWAP8 SWAP5 POP POP POP POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x0 DUP1 PUSH20 0x0 PUSH4 0x2C607C3B PUSH2 0x3E2 DUP13 DUP9 DUP11 PUSH2 0x4A7 JUMP JUMPDEST DUP12 DUP11 DUP16 PUSH1 0x2 DUP15 PUSH1 0x2 DUP2 GT ISZERO PUSH2 0x407 JUMPI PUSH4 0x4E487B71 PUSH1 0xE0 SHL PUSH1 0x0 MSTORE PUSH1 0x21 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH1 0x0 REVERT JUMPDEST EQ PUSH1 0x40 MLOAD DUP7 PUSH4 0xFFFFFFFF AND PUSH1 0xE0 SHL DUP2 MSTORE PUSH1 0x4 ADD PUSH2 0x428 SWAP6 SWAP5 SWAP4 SWAP3 SWAP2 SWAP1 PUSH2 0xB73 JUMP JUMPDEST PUSH1 0x20 PUSH1 0x40 MLOAD DUP1 DUP4 SUB DUP2 DUP7 DUP1 EXTCODESIZE ISZERO DUP1 ISZERO PUSH2 0x440 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP GAS DELEGATECALL ISZERO DUP1 ISZERO PUSH2 0x454 JUMPI RETURNDATASIZE PUSH1 0x0 DUP1 RETURNDATACOPY RETURNDATASIZE PUSH1 0x0 REVERT JUMPDEST POP POP POP POP PUSH1 0x40 MLOAD RETURNDATASIZE PUSH1 0x1F NOT PUSH1 0x1F DUP3 ADD AND DUP3 ADD DUP1 PUSH1 0x40 MSTORE POP DUP2 ADD SWAP1 PUSH2 0x478 SWAP2 SWAP1 PUSH2 0x9F7 JUMP JUMPDEST SWAP1 POP PUSH2 0x484 DUP11 DUP8 PUSH2 0x7B9 JUMP JUMPDEST SWAP3 POP DUP7 PUSH2 0x491 DUP12 DUP4 PUSH2 0xBFC JUMP JUMPDEST PUSH2 0x49B SWAP2 SWAP1 PUSH2 0xBDC JUMP JUMPDEST SWAP2 POP PUSH2 0x3A7 DUP3 DUP5 PUSH2 0xBC4 JUMP JUMPDEST PUSH1 0x0 DUP2 PUSH1 0x1 PUSH1 0x1 PUSH1 0xA0 SHL SUB AND PUSH4 0x18F88E5B PUSH1 0x40 MLOAD DUP2 PUSH4 0xFFFFFFFF AND PUSH1 0xE0 SHL DUP2 MSTORE PUSH1 0x4 ADD PUSH1 0x20 PUSH1 0x40 MLOAD DUP1 DUP4 SUB DUP2 DUP7 DUP1 EXTCODESIZE ISZERO DUP1 ISZERO PUSH2 0x4E2 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP GAS STATICCALL ISZERO DUP1 ISZERO PUSH2 0x4F6 JUMPI RETURNDATASIZE PUSH1 0x0 DUP1 RETURNDATACOPY RETURNDATASIZE PUSH1 0x0 REVERT JUMPDEST POP POP POP POP PUSH1 0x40 MLOAD RETURNDATASIZE PUSH1 0x1F NOT PUSH1 0x1F DUP3 ADD AND DUP3 ADD DUP1 PUSH1 0x40 MSTORE POP DUP2 ADD SWAP1 PUSH2 0x51A SWAP2 SWAP1 PUSH2 0x9F7 JUMP JUMPDEST SWAP1 POP PUSH1 0x0 PUSH2 0x528 DUP6 DUP6 PUSH2 0x12F JUMP JUMPDEST SWAP1 POP PUSH4 0xEE6B2800 DUP2 GT ISZERO PUSH2 0x5D6 JUMPI DUP3 PUSH1 0x1 PUSH1 0x1 PUSH1 0xA0 SHL SUB AND PUSH4 0x6C321C8A PUSH1 0x40 MLOAD DUP2 PUSH4 0xFFFFFFFF AND PUSH1 0xE0 SHL DUP2 MSTORE PUSH1 0x4 ADD PUSH1 0x20 PUSH1 0x40 MLOAD DUP1 DUP4 SUB DUP2 DUP7 DUP1 EXTCODESIZE ISZERO DUP1 ISZERO PUSH2 0x56F JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP GAS STATICCALL ISZERO DUP1 ISZERO PUSH2 0x583 JUMPI RETURNDATASIZE PUSH1 0x0 DUP1 RETURNDATACOPY RETURNDATASIZE PUSH1 0x0 REVERT JUMPDEST POP POP POP POP PUSH1 0x40 MLOAD RETURNDATASIZE PUSH1 0x1F NOT PUSH1 0x1F DUP3 ADD AND DUP3 ADD DUP1 PUSH1 0x40 MSTORE POP DUP2 ADD SWAP1 PUSH2 0x5A7 SWAP2 SWAP1 PUSH2 0x9F7 JUMP JUMPDEST PUSH2 0x5B5 PUSH4 0xEE6B2800 DUP4 PUSH2 0xC1B JUMP JUMPDEST PUSH2 0x5BF SWAP1 DUP5 PUSH2 0xBFC JUMP JUMPDEST PUSH2 0x5C9 SWAP2 SWAP1 PUSH2 0xBDC JUMP JUMPDEST PUSH2 0x5D3 SWAP1 DUP4 PUSH2 0xBC4 JUMP JUMPDEST SWAP2 POP JUMPDEST POP SWAP4 SWAP3 POP POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x0 PUSH2 0x5F3 DUP11 DUP6 DUP8 DUP13 DUP16 DUP12 DUP15 DUP15 PUSH2 0x849 JUMP JUMPDEST SWAP1 POP PUSH2 0x5FF DUP11 DUP7 PUSH2 0x7B9 JUMP JUMPDEST SWAP2 POP PUSH2 0x60B DUP2 DUP4 PUSH2 0xBC4 JUMP JUMPDEST SWAP3 POP SWAP9 POP SWAP9 POP SWAP9 SWAP6 POP POP POP POP POP POP JUMP JUMPDEST PUSH1 0x0 PUSH4 0x5F5E100 DUP9 PUSH20 0x0 PUSH4 0xD573D615 PUSH2 0x648 DUP13 DUP8 DUP10 PUSH2 0x4A7 JUMP JUMPDEST DUP12 DUP10 DUP16 DUP14 DUP14 PUSH1 0x40 MLOAD DUP8 PUSH4 0xFFFFFFFF AND PUSH1 0xE0 SHL DUP2 MSTORE PUSH1 0x4 ADD PUSH2 0x66E SWAP7 SWAP6 SWAP5 SWAP4 SWAP3 SWAP2 SWAP1 PUSH2 0xB98 JUMP JUMPDEST PUSH1 0x20 PUSH1 0x40 MLOAD DUP1 DUP4 SUB DUP2 DUP7 DUP1 EXTCODESIZE ISZERO DUP1 ISZERO PUSH2 0x686 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP GAS DELEGATECALL ISZERO DUP1 ISZERO PUSH2 0x69A JUMPI RETURNDATASIZE PUSH1 0x0 DUP1 RETURNDATACOPY RETURNDATASIZE PUSH1 0x0 REVERT JUMPDEST POP POP POP POP PUSH1 0x40 MLOAD RETURNDATASIZE PUSH1 0x1F NOT PUSH1 0x1F DUP3 ADD AND DUP3 ADD DUP1 PUSH1 0x40 MSTORE POP DUP2 ADD SWAP1 PUSH2 0x6BE SWAP2 SWAP1 PUSH2 0x9F7 JUMP JUMPDEST PUSH2 0x6C8 SWAP2 SWAP1 PUSH2 0xBFC JUMP JUMPDEST PUSH2 0x6D2 SWAP2 SWAP1 PUSH2 0xBDC JUMP JUMPDEST SWAP10 SWAP9 POP POP POP POP POP POP POP POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH20 0x0 PUSH4 0xD573D615 PUSH2 0x70B DUP10 PUSH1 0x20 ADD MLOAD DUP10 DUP10 PUSH2 0x4A7 JUMP JUMPDEST PUSH1 0x40 DUP1 DUP12 ADD MLOAD DUP12 MLOAD PUSH1 0x60 DUP14 ADD MLOAD PUSH1 0x80 DUP15 ADD MLOAD SWAP4 MLOAD PUSH1 0x1 PUSH1 0x1 PUSH1 0xE0 SHL SUB NOT PUSH1 0xE0 DUP9 SWAP1 SHL AND DUP2 MSTORE PUSH2 0x741 SWAP6 SWAP5 DUP12 SWAP4 SWAP3 SWAP2 PUSH1 0x4 ADD PUSH2 0xB98 JUMP JUMPDEST PUSH1 0x20 PUSH1 0x40 MLOAD DUP1 DUP4 SUB DUP2 DUP7 DUP1 EXTCODESIZE ISZERO DUP1 ISZERO PUSH2 0x759 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP GAS DELEGATECALL ISZERO DUP1 ISZERO PUSH2 0x76D JUMPI RETURNDATASIZE PUSH1 0x0 DUP1 RETURNDATACOPY RETURNDATASIZE PUSH1 0x0 REVERT JUMPDEST POP POP POP POP PUSH1 0x40 MLOAD RETURNDATASIZE PUSH1 0x1F NOT PUSH1 0x1F DUP3 ADD AND DUP3 ADD DUP1 PUSH1 0x40 MSTORE POP DUP2 ADD SWAP1 PUSH2 0x791 SWAP2 SWAP1 PUSH2 0x9F7 JUMP JUMPDEST SWAP1 POP DUP4 DUP8 PUSH1 0x20 ADD MLOAD DUP3 PUSH2 0x7A4 SWAP2 SWAP1 PUSH2 0xBFC JUMP JUMPDEST PUSH2 0x7AE SWAP2 SWAP1 PUSH2 0xBDC JUMP JUMPDEST SWAP8 SWAP7 POP POP POP POP POP POP POP JUMP JUMPDEST PUSH1 0x0 PUSH1 0x64 DUP3 PUSH1 0x1 PUSH1 0x1 PUSH1 0xA0 SHL SUB AND PUSH4 0xF3FA3495 PUSH1 0x40 MLOAD DUP2 PUSH4 0xFFFFFFFF AND PUSH1 0xE0 SHL DUP2 MSTORE PUSH1 0x4 ADD PUSH1 0x20 PUSH1 0x40 MLOAD DUP1 DUP4 SUB DUP2 DUP7 DUP1 EXTCODESIZE ISZERO DUP1 ISZERO PUSH2 0x7F6 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP GAS STATICCALL ISZERO DUP1 ISZERO PUSH2 0x80A JUMPI RETURNDATASIZE PUSH1 0x0 DUP1 RETURNDATACOPY RETURNDATASIZE PUSH1 0x0 REVERT JUMPDEST POP POP POP POP PUSH1 0x40 MLOAD RETURNDATASIZE PUSH1 0x1F NOT PUSH1 0x1F DUP3 ADD AND DUP3 ADD DUP1 PUSH1 0x40 MSTORE POP DUP2 ADD SWAP1 PUSH2 0x82E SWAP2 SWAP1 PUSH2 0x9F7 JUMP JUMPDEST PUSH2 0x838 SWAP1 DUP6 PUSH2 0xBFC JUMP JUMPDEST PUSH2 0x842 SWAP2 SWAP1 PUSH2 0xBDC JUMP JUMPDEST SWAP4 SWAP3 POP POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH20 0x0 PUSH4 0xD573D615 PUSH2 0x871 DUP13 DUP13 DUP13 PUSH2 0x4A7 JUMP JUMPDEST DUP10 DUP9 DUP11 DUP10 DUP10 PUSH1 0x40 MLOAD DUP8 PUSH4 0xFFFFFFFF AND PUSH1 0xE0 SHL DUP2 MSTORE PUSH1 0x4 ADD PUSH2 0x897 SWAP7 SWAP6 SWAP5 SWAP4 SWAP3 SWAP2 SWAP1 PUSH2 0xB98 JUMP JUMPDEST PUSH1 0x20 PUSH1 0x40 MLOAD DUP1 DUP4 SUB DUP2 DUP7 DUP1 EXTCODESIZE ISZERO DUP1 ISZERO PUSH2 0x8AF JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP GAS DELEGATECALL ISZERO DUP1 ISZERO PUSH2 0x8C3 JUMPI RETURNDATASIZE PUSH1 0x0 DUP1 RETURNDATACOPY RETURNDATASIZE PUSH1 0x0 REVERT JUMPDEST POP POP POP POP PUSH1 0x40 MLOAD RETURNDATASIZE PUSH1 0x1F NOT PUSH1 0x1F DUP3 ADD AND DUP3 ADD DUP1 PUSH1 0x40 MSTORE POP DUP2 ADD SWAP1 PUSH2 0x8E7 SWAP2 SWAP1 PUSH2 0x9F7 JUMP JUMPDEST SWAP1 POP DUP5 PUSH2 0x8F4 DUP12 DUP4 PUSH2 0xBFC JUMP JUMPDEST PUSH2 0x8FE SWAP2 SWAP1 PUSH2 0xBDC JUMP JUMPDEST SWAP11 SWAP10 POP POP POP POP POP POP POP POP POP POP JUMP JUMPDEST DUP1 CALLDATALOAD DUP1 ISZERO ISZERO DUP2 EQ PUSH2 0x91C JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST SWAP2 SWAP1 POP JUMP JUMPDEST DUP1 CALLDATALOAD PUSH2 0x91C DUP2 PUSH2 0xC48 JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x0 DUP1 PUSH1 0x0 DUP6 DUP8 SUB PUSH2 0x120 DUP2 SLT ISZERO PUSH2 0x945 JUMPI DUP2 DUP3 REVERT JUMPDEST PUSH1 0xA0 DUP2 SLT ISZERO PUSH2 0x952 JUMPI DUP2 DUP3 REVERT JUMPDEST POP PUSH1 0x40 MLOAD PUSH1 0xA0 DUP2 ADD PUSH1 0x1 PUSH1 0x1 PUSH1 0x40 SHL SUB DUP2 GT DUP3 DUP3 LT OR ISZERO PUSH2 0x981 JUMPI PUSH4 0x4E487B71 PUSH1 0xE0 SHL DUP4 MSTORE PUSH1 0x41 PUSH1 0x4 MSTORE PUSH1 0x24 DUP4 REVERT JUMPDEST DUP1 PUSH1 0x40 MSTORE POP DUP7 CALLDATALOAD DUP2 MSTORE PUSH1 0x20 DUP8 ADD CALLDATALOAD PUSH1 0x20 DUP3 ADD MSTORE PUSH1 0x40 DUP8 ADD CALLDATALOAD PUSH1 0x40 DUP3 ADD MSTORE PUSH2 0x9AA PUSH1 0x60 DUP9 ADD PUSH2 0x90C JUMP JUMPDEST PUSH1 0x60 DUP3 ADD MSTORE PUSH2 0x9BB PUSH1 0x80 DUP9 ADD PUSH2 0x90C JUMP JUMPDEST PUSH1 0x80 DUP3 ADD MSTORE SWAP5 POP PUSH1 0xA0 DUP7 ADD CALLDATALOAD SWAP4 POP PUSH1 0xC0 DUP7 ADD CALLDATALOAD SWAP3 POP PUSH2 0x9DC PUSH1 0xE0 DUP8 ADD PUSH2 0x921 JUMP JUMPDEST SWAP2 POP PUSH2 0x9EB PUSH2 0x100 DUP8 ADD PUSH2 0x921 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP6 POP SWAP3 SWAP6 SWAP1 SWAP4 POP JUMP JUMPDEST PUSH1 0x0 PUSH1 0x20 DUP3 DUP5 SUB SLT ISZERO PUSH2 0xA08 JUMPI DUP1 DUP2 REVERT JUMPDEST POP MLOAD SWAP2 SWAP1 POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xA21 JUMPI DUP2 DUP3 REVERT JUMPDEST DUP3 CALLDATALOAD SWAP2 POP PUSH1 0x20 DUP4 ADD CALLDATALOAD PUSH2 0xA33 DUP2 PUSH2 0xC48 JUMP JUMPDEST DUP1 SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x0 PUSH1 0x60 DUP5 DUP7 SUB SLT ISZERO PUSH2 0xA52 JUMPI DUP3 DUP4 REVERT JUMPDEST DUP4 CALLDATALOAD SWAP3 POP PUSH1 0x20 DUP5 ADD CALLDATALOAD PUSH2 0xA64 DUP2 PUSH2 0xC48 JUMP JUMPDEST SWAP2 POP PUSH1 0x40 DUP5 ADD CALLDATALOAD PUSH2 0xA74 DUP2 PUSH2 0xC48 JUMP JUMPDEST DUP1 SWAP2 POP POP SWAP3 POP SWAP3 POP SWAP3 JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x0 DUP1 PUSH1 0x0 DUP1 PUSH1 0x0 DUP1 PUSH2 0x100 DUP10 DUP12 SUB SLT ISZERO PUSH2 0xA9B JUMPI DUP3 DUP4 REVERT JUMPDEST DUP9 CALLDATALOAD SWAP8 POP PUSH1 0x20 DUP10 ADD CALLDATALOAD SWAP7 POP PUSH1 0x40 DUP10 ADD CALLDATALOAD SWAP6 POP PUSH2 0xAB9 PUSH1 0x60 DUP11 ADD PUSH2 0x90C JUMP JUMPDEST SWAP5 POP PUSH2 0xAC7 PUSH1 0x80 DUP11 ADD PUSH2 0x90C JUMP JUMPDEST SWAP4 POP PUSH1 0xA0 DUP10 ADD CALLDATALOAD SWAP3 POP PUSH1 0xC0 DUP10 ADD CALLDATALOAD PUSH2 0xADE DUP2 PUSH2 0xC48 JUMP JUMPDEST SWAP2 POP PUSH1 0xE0 DUP10 ADD CALLDATALOAD PUSH2 0xAEE DUP2 PUSH2 0xC48 JUMP JUMPDEST DUP1 SWAP2 POP POP SWAP3 SWAP6 SWAP9 POP SWAP3 SWAP6 SWAP9 SWAP1 SWAP4 SWAP7 POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x0 DUP1 PUSH1 0x0 DUP1 PUSH1 0x0 PUSH1 0xE0 DUP9 DUP11 SUB SLT ISZERO PUSH2 0xB19 JUMPI DUP3 DUP4 REVERT JUMPDEST DUP8 CALLDATALOAD SWAP7 POP PUSH1 0x20 DUP9 ADD CALLDATALOAD SWAP6 POP PUSH1 0x40 DUP9 ADD CALLDATALOAD SWAP5 POP PUSH1 0x60 DUP9 ADD CALLDATALOAD PUSH1 0x3 DUP2 LT PUSH2 0xB3C JUMPI DUP4 DUP5 REVERT JUMPDEST SWAP4 POP PUSH1 0x80 DUP9 ADD CALLDATALOAD SWAP3 POP PUSH1 0xA0 DUP9 ADD CALLDATALOAD PUSH2 0xB53 DUP2 PUSH2 0xC48 JUMP JUMPDEST SWAP2 POP PUSH1 0xC0 DUP9 ADD CALLDATALOAD PUSH2 0xB63 DUP2 PUSH2 0xC48 JUMP JUMPDEST DUP1 SWAP2 POP POP SWAP3 SWAP6 SWAP9 SWAP2 SWAP5 SWAP8 POP SWAP3 SWAP6 POP JUMP JUMPDEST SWAP5 DUP6 MSTORE PUSH1 0x20 DUP6 ADD SWAP4 SWAP1 SWAP4 MSTORE PUSH1 0x40 DUP5 ADD SWAP2 SWAP1 SWAP2 MSTORE PUSH1 0x60 DUP4 ADD MSTORE ISZERO ISZERO PUSH1 0x80 DUP3 ADD MSTORE PUSH1 0xA0 ADD SWAP1 JUMP JUMPDEST SWAP6 DUP7 MSTORE PUSH1 0x20 DUP7 ADD SWAP5 SWAP1 SWAP5 MSTORE PUSH1 0x40 DUP6 ADD SWAP3 SWAP1 SWAP3 MSTORE PUSH1 0x60 DUP5 ADD MSTORE ISZERO ISZERO PUSH1 0x80 DUP4 ADD MSTORE ISZERO ISZERO PUSH1 0xA0 DUP3 ADD MSTORE PUSH1 0xC0 ADD SWAP1 JUMP JUMPDEST PUSH1 0x0 DUP3 NOT DUP3 GT ISZERO PUSH2 0xBD7 JUMPI PUSH2 0xBD7 PUSH2 0xC32 JUMP JUMPDEST POP ADD SWAP1 JUMP JUMPDEST PUSH1 0x0 DUP3 PUSH2 0xBF7 JUMPI PUSH4 0x4E487B71 PUSH1 0xE0 SHL DUP2 MSTORE PUSH1 0x12 PUSH1 0x4 MSTORE PUSH1 0x24 DUP2 REVERT JUMPDEST POP DIV SWAP1 JUMP JUMPDEST PUSH1 0x0 DUP2 PUSH1 0x0 NOT DIV DUP4 GT DUP3 ISZERO ISZERO AND ISZERO PUSH2 0xC16 JUMPI PUSH2 0xC16 PUSH2 0xC32 JUMP JUMPDEST POP MUL SWAP1 JUMP JUMPDEST PUSH1 0x0 DUP3 DUP3 LT ISZERO PUSH2 0xC2D JUMPI PUSH2 0xC2D PUSH2 0xC32 JUMP JUMPDEST POP SUB SWAP1 JUMP JUMPDEST PUSH4 0x4E487B71 PUSH1 0xE0 SHL PUSH1 0x0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH1 0x0 REVERT JUMPDEST PUSH1 0x1 PUSH1 0x1 PUSH1 0xA0 SHL SUB DUP2 AND DUP2 EQ PUSH2 0xC5D JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 SELFBALANCE XOR 0xCC PUSH8 0x318816A547E043D0 0x4E DUP9 PUSH16 0x3154CEACF08E3AC1E83DE0647CEAD34A 0xDA PUSH5 0x736F6C6343 STOP ADDMOD DIV STOP CALLER ", "sha1": "6ff361dfb1ab3644e9a38fb36195f3b261612340", "source": "// SPDX-License-Identifier: BUSL-1.1\n\npragma solidity ^0.8.0;\n\n/**\n * Smart contract library of mathematical functions operating with signed\n * 64.64-bit fixed point numbers.  Signed 64.64-bit fixed point number is\n * basically a simple fraction whose numerator is signed 128-bit integer and\n * denominator is 2^64.  As long as denominator is always the same, there is no\n * need to store it, thus in Solidity signed 64.64-bit fixed point numbers are\n * represented by int128 type holding only the numerator.\n */\nimport \"../Libraries/OptionMath.sol\";\nimport \"../Options/OptionConfig.sol\";\nimport \"../Interfaces/Interfaces.sol\";\nimport \"../Pool/BufferIBFRPoolV2.sol\";\n\nlibrary FeeCalculator {\n    /**\n     * @notice Calculate the current Utilisation\n     * @param amount Option amount\n     * @param pool The pool selling the option\n     * @return utilization Current utilization\n     */\n    function getNewUtilisation(uint256 amount, BufferIBFRPoolV2 pool)\n        public\n        view\n        returns (uint256 utilization)\n    {\n        uint256 poolBalance = pool.totalTokenXBalance();\n        require(poolBalance > 0, \"O8\");\n\n        utilization = ((pool.lockedAmount() + amount) * 100e8) / poolBalance;\n    }\n\n    /**\n     * @notice Calculate the Utilisation adjusted ImpliedVol for the pool according to https://www.desmos.com/calculator/xdmhn97opd\n     * @param amount Option amount\n     * @param pool The pool selling the option\n     * @param config The option configuration\n     * @return iv The adjusted ImpliedVol\n     */\n    function currentImpliedVolatility(\n        uint256 amount,\n        BufferIBFRPoolV2 pool,\n        OptionConfig config\n    ) public view returns (uint256 iv) {\n        iv = config.impliedVolRate();\n        uint256 utilization = getNewUtilisation(amount, pool);\n        if (utilization > 40e8) {\n            iv += (iv * (utilization - 40e8)) / config.utilizationRate();\n        }\n    }\n\n    /**\n     * @notice Used for getting the price for Options in tokenX\n     * @param period Option period in seconds (1 days <= period <= 4 weeks)\n     * @param amount Option amount\n     * @param strike Strike price of the option\n     * @param optionType Type of the Option\n     * @param currentPrice Current price of the underlying asset\n     * @param config The option configuration\n     * @param pool The pool selling the option\n     * @return total Total price to be paid\n     * @return settlementFee Amount to be distributed to the Buffer token holders\n     * @return premium Amount that covers the price difference in the ITM options\n     */\n    function fees(\n        uint256 period,\n        uint256 amount,\n        uint256 strike,\n        IBufferOptions.OptionType optionType,\n        uint256 currentPrice,\n        OptionConfig config,\n        BufferIBFRPoolV2 pool\n    )\n        public\n        view\n        returns (\n            uint256 total,\n            uint256 settlementFee,\n            uint256 premium\n        )\n    {\n        // usdPremium per amount is USD Price of the option in 1e8\n        uint256 usdPremium = OptionMath.blackScholesPrice(\n            currentImpliedVolatility(amount, pool, config),\n            strike,\n            currentPrice,\n            period,\n            optionType == IBufferOptions.OptionType.Call\n        );\n        premium = (usdPremium * amount) / currentPrice;\n        settlementFee = getSettlementFee(amount, config);\n        total = settlementFee + premium;\n    }\n\n    /**\n     * @notice Used for getting the price for Options in USD\n     * @param period Option period in seconds (1 days <= period <= 4 weeks)\n     * @param amount Option amount\n     * @param strike Strike price of the option\n     * @param optionType Type of the Option\n     * @param currentPrice Current price of the underlying asset\n     * @param config The option configuration\n     * @param pool The pool selling the option\n     * @return total Total price to be paid in USD\n     * @return settlementFee Amount to be distributed to the Buffer token holders in USD\n     * @return premium Amount that covers the price difference in the ITM options in USD\n     */\n    function feesUsd(\n        uint256 period,\n        uint256 amount,\n        uint256 strike,\n        IBufferOptions.OptionType optionType,\n        uint256 currentPrice,\n        OptionConfig config,\n        BufferIBFRPoolV2 pool\n    )\n        public\n        view\n        returns (\n            uint256 total,\n            uint256 settlementFee,\n            uint256 premium\n        )\n    {\n        // usdPremium per asset amount is USD Price of the option in 1e8\n        uint256 usdPremium = OptionMath.blackScholesPrice(\n            currentImpliedVolatility(amount, pool, config),\n            strike,\n            currentPrice,\n            period,\n            optionType == IBufferOptions.OptionType.Call\n        );\n        settlementFee = getSettlementFee(amount, config);\n        premium = (usdPremium * amount) / currentPrice;\n        total = settlementFee + premium;\n    }\n\n    /**\n     * @notice Used for getting the price for Binary Options\n     * @param period Option period in seconds (1 days <= period <= 4 weeks)\n     * @param amount Option amount\n     * @param strike Strike price of the option\n     * @param isYes whether the option isAbove or not\n     * @param isAbove whether the price will stay above this strike or not\n     * @param currentPrice Current price of the underlying asset\n     * @param config The option configuration\n     * @param pool The pool selling the option\n     * @return premium Amount that covers the price difference in the ITM options\n     */\n    function feesTokenXBinary(\n        uint256 period,\n        uint256 amount,\n        uint256 strike,\n        bool isYes,\n        bool isAbove,\n        uint256 currentPrice,\n        OptionConfig config,\n        BufferIBFRPoolV2 pool\n    )\n        external\n        view\n        returns (\n            uint256 premium\n        )\n    {\n        premium = OptionMath.blackScholesPriceBinary(\n            currentImpliedVolatility(amount, pool, config),\n            strike,\n            currentPrice,\n            period,\n            isYes,\n            isAbove\n        ) * amount / 1e8;\n    }\n\n\n    /**\n     * @notice Used for getting the price for Binary Options\n     * @param period Option period in seconds (1 days <= period <= 4 weeks)\n     * @param amount Option amount\n     * @param strike Strike price of the option\n     * @param isYes whether the option isAbove or not\n     * @param isAbove whether the price will stay above this strike or not\n     * @param currentPrice Current price of the underlying asset\n     * @param config The option configuration\n     * @param pool The pool selling the option\n     * @return total Total price to be paid\n     * @return settlementFee Amount to be distributed to the Buffer token holders\n     * @return premium Amount that covers the price difference in the ITM options\n     */\n    function feesBinary(\n        uint256 period,\n        uint256 amount,\n        uint256 strike,\n        bool isYes,\n        bool isAbove,\n        uint256 currentPrice,\n        OptionConfig config,\n        BufferIBFRPoolV2 pool\n    )\n        external\n        view\n        returns (\n            uint256 total,\n            uint256 settlementFee,\n            uint256 premium\n        )\n    {\n        premium = getPremium(\n            amount,\n            pool,\n            config,\n            strike,\n            period,\n            currentPrice,\n            isYes,\n            isAbove\n        );\n        settlementFee = getSettlementFee(amount, config);\n        total = settlementFee + premium;\n    }\n\n    /**\n     * @notice Used for getting the price for Binary KPI Options\n     * @param optionDetails Details of the option to be priced\n     * @param currentPrice Current price of the tokenX\n     * @param KPI KPI value for option\n     * @param config Option config\n     * @param pool pool contract\n     * @return total Total price to be paid\n     * @return settlementFee Amount to be distributed to the Buffer token holders\n     * @return premium Amount that covers the price difference in the ITM options\n     */\n    function feesKPIBinary(\n        IBufferOptions.OptionDetails memory optionDetails,\n        uint256 currentPrice,\n        uint256 KPI,\n        OptionConfig config,\n        BufferIBFRPoolV2 pool\n    )\n        external\n        view\n        returns (\n            uint256 total,\n            uint256 settlementFee,\n            uint256 premium\n        )\n    {\n        premium = getPremiumBinary(\n            optionDetails,\n            pool,\n            config,\n            currentPrice,\n            KPI\n        );\n        settlementFee = getSettlementFee(optionDetails.amount, config);\n        total = settlementFee + premium;\n    }\n\n    /**\n     * @notice Calculates settlementFee\n     * @param amount Option amount\n     * @return fee Settlement fee amount\n     */\n    function getSettlementFee(uint256 amount, OptionConfig config)\n        internal\n        view\n        returns (uint256 fee)\n    {\n        return (amount * config.settlementFeePercentage()) / 100;\n    }\n\n    function getPremium(\n        uint256 amount,\n        BufferIBFRPoolV2 pool,\n        OptionConfig config,\n        uint256 strike,\n        uint256 period,\n        uint256 currentPrice,\n        bool isYes,\n        bool isAbove\n    ) internal view returns (uint256 premium) {\n        // usdPremium per amount is USD Price of the option in 1e8\n        uint256 usdPremium = OptionMath.blackScholesPriceBinary(\n            currentImpliedVolatility(amount, pool, config),\n            strike,\n            currentPrice,\n            period,\n            isYes,\n            isAbove\n        );\n        premium = (usdPremium * amount) / currentPrice;\n    }\n\n    function getPremiumBinary(\n        IBufferOptions.OptionDetails memory optionDetails,\n        BufferIBFRPoolV2 pool,\n        OptionConfig config,\n        uint256 currentPrice,\n        uint256 KPI\n    ) internal view returns (uint256 premium) {\n        // usdPremium per amount is USD Price of the option in 1e8\n        uint256 usdPremium = OptionMath.blackScholesPriceBinary(\n            currentImpliedVolatility(optionDetails.amount, pool, config),\n            optionDetails.strike,\n            KPI,\n            optionDetails.period,\n            optionDetails.isYes,\n            optionDetails.isAbove\n        );\n        premium = (usdPremium * optionDetails.amount) / currentPrice;\n    }\n}\n", "sourceMap": "668:9750:19:-:0;;;;;;;;;;;;;;;-1:-1:-1;;;668:9750:19;;;;;;;;;;;;;;;;;", "sourcePath": "contracts/Libraries/OptionFeeCalculator.sol", "deployment": {"address": "0x98ecb38A7dBf2518C24F3Dd793284a24d2B39629", "chainid": "1819", "blockHeight": 1841207}}